"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[325],{8918:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(1180),r=i(7458),s=i(3803),o=i(1855),a=i(5409);class l extends r.Z{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){let{object:t}=e,i=t&&t.__source&&t.__source.parent&&t.__source.parent.id===this.id;return i&&(e.object=t.__source.object,e.index=t.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){let{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||t}getSubLayerRow(e,t,i){return e.__source={parent:this,object:t,index:i},e}getSubLayerAccessor(e){if("function"==typeof e){let t={index:-1,data:this.props.data,target:[]};return(i,n)=>i&&i.__source?(t.index=i.__source.index,e(i.__source.object,t)):e(i,n)}return e}getSubLayerProps(e={}){var t;let{opacity:i,pickable:n,visible:r,parameters:s,getPolygonOffset:o,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:d,wrapLongitude:f,positionFormat:g,modelMatrix:p,extensions:A,fetch:m,operation:C,_subLayerProps:B}=this.props,_={id:"",updateTriggers:{},opacity:i,pickable:n,visible:r,parameters:s,getPolygonOffset:o,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:d,wrapLongitude:f,positionFormat:g,modelMatrix:p,extensions:A,fetch:m,operation:C},v=B&&e.id&&B[e.id],y=v&&v.updateTriggers,b=e.id||"sublayer";if(v){let t=this.props[a.Wb],i=e.type?e.type._propTypes:{};for(let e in v){let n=i[e]||t[e];n&&"accessor"===n.type&&(v[e]=this.getSubLayerAccessor(v[e]))}}for(let i of(Object.assign(_,e,v),_.id="".concat(this.props.id,"-").concat(b),_.updateTriggers={all:null===(t=this.props.updateTriggers)||void 0===t?void 0:t.all,...e.updateTriggers,...y},A)){let e=i.getSubLayerProps.call(this,i);e&&Object.assign(_,e,{updateTriggers:Object.assign(_.updateTriggers,e.updateTriggers)})}return _}_updateAutoHighlight(e){for(let t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let i=this.internalState.subLayers,n=!i||this.needsUpdate();if(n){let e=this.renderLayers();i=(0,o.x)(e,Boolean),this.internalState.subLayers=i}for(let e of((0,s.Z)("compositeLayer.renderLayers",this,n,i),i))e.parent=this}}(0,n.Z)(l,"layerName","CompositeLayer")},9965:function(e,t,i){i.d(t,{Z:function(){return s}});let n=new Uint8Array([0,255,255,255]),r={pickingSelectedColor:null,pickingHighlightColor:n,pickingActive:!1,pickingAttribute:!1};var s={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:#decl":"\nuniform bool picking_uAttribute;\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t={};if(void 0!==e.pickingSelectedColor){if(e.pickingSelectedColor){let i=e.pickingSelectedColor.slice(0,3);t.picking_uSelectedColorValid=1,t.picking_uSelectedColor=i}else t.picking_uSelectedColorValid=0}if(e.pickingHighlightColor){let i=Array.from(e.pickingHighlightColor,e=>e/255);Number.isFinite(i[3])||(i[3]=1),t.picking_uHighlightColor=i}return void 0!==e.pickingActive&&(t.picking_uActive=!!e.pickingActive,t.picking_uAttribute=!!e.pickingAttribute),t}}},3844:function(e,t,i){var n=i(2189);t.Z={name:"project32",dependencies:[n.Z],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"}},8005:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(1180),r=i(8550),s=i(6610),o=i(5304),a=i(3478);class l{constructor(e){(0,n.Z)(this,"opts",void 0),(0,n.Z)(this,"typedArrayManager",void 0),(0,n.Z)(this,"indexStarts",[0]),(0,n.Z)(this,"vertexStarts",[0]),(0,n.Z)(this,"vertexCount",0),(0,n.Z)(this,"instanceCount",0),(0,n.Z)(this,"attributes",void 0),(0,n.Z)(this,"_attributeDefs",void 0),(0,n.Z)(this,"data",void 0),(0,n.Z)(this,"getGeometry",void 0),(0,n.Z)(this,"geometryBuffer",void 0),(0,n.Z)(this,"buffers",void 0),(0,n.Z)(this,"positionSize",void 0),(0,n.Z)(this,"normalize",void 0);let{attributes:t={}}=e;this.typedArrayManager=s.Z,this.attributes={},this._attributeDefs=t,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);let{data:t,buffers:i={},getGeometry:n,geometryBuffer:r,positionFormat:s,dataChanged:a,normalize:l=!0}=this.opts;if(this.data=t,this.getGeometry=n,this.positionSize=r&&r.size||("XY"===s?2:3),this.buffers=i,this.normalize=l,r&&((0,o.Z)(t.startIndices),this.getGeometry=this.getGeometryFromBuffer(r),l||(i.positions=r)),this.geometryBuffer=i.positions,Array.isArray(a))for(let e of a)this._rebuildGeometry(e);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:t}){this._rebuildGeometry({startRow:e,endRow:t})}getGeometryFromBuffer(e){let t=e.value||e;return ArrayBuffer.isView(t)?(0,r.jr)(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,t){let{attributes:i,buffers:n,_attributeDefs:r,typedArrayManager:s}=this;for(let o in r)if(o in n)s.release(i[o]),i[o]=null;else{let n=r[o];n.copy=t,i[o]=s.allocate(i[o],e,n)}}_forEachGeometry(e,t,i){let{data:n,getGeometry:s}=this,{iterable:o,objectInfo:a}=(0,r.jB)(n,t,i);for(let t of o){a.index++;let i=s?s(t,a):null;e(i,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:t,vertexStarts:i,instanceCount:n}=this,{data:r,geometryBuffer:s}=this,{startRow:o=0,endRow:l=1/0}=e||{},c={};if(e||(t=[0],i=[0]),this.normalize||!s)this._forEachGeometry((e,t)=>{let n=e&&this.normalizeGeometry(e);c[t]=n,i[t+1]=i[t]+(n?this.getGeometrySize(n):0)},o,l),n=i[i.length-1];else if(n=(i=r.startIndices)[r.length]||0,ArrayBuffer.isView(s))n=n||s.length/this.positionSize;else if(s instanceof a.Z){let e=s.accessor.stride||4*this.positionSize;n=n||s.byteLength/e}else if(s.buffer){let e=s.stride||4*this.positionSize;n=n||s.buffer.byteLength/e}else if(s.value){let e=s.value,t=s.stride/e.BYTES_PER_ELEMENT||this.positionSize;n=n||e.length/t}this._allocate(n,!!e),this.indexStarts=t,this.vertexStarts=i,this.instanceCount=n;let u={};this._forEachGeometry((e,r)=>{let s=c[r]||e;u.vertexStart=i[r],u.indexStart=t[r];let o=r<i.length-1?i[r+1]:n;u.geometrySize=o-i[r],u.geometryIndex=r,this.updateGeometryAttributes(s,u)},o,l),this.vertexCount=t[t.length-1]}}},3687:function(e,t,i){i.d(t,{Z:function(){return I}});var n=i(1180),r=i(8918),s=i(744),o=i(7458),a=i(3844),l=i(8674),c=i(9965),u=i(3982),h=i(1418),d=i(1621),f=i(5462),g=i(4211),p=i(6948),A=i(7805),m=i(435);function C(e,t){let i=e.COLOR_0||e.colors;i&&t||(e.colors={constant:!0,value:new Float32Array([1,1,1])}),s.Z.assert(e.positions||e.POSITION,'no "postions" or "POSITION" attribute in mesh')}function B(e,t){if(e.attributes)return(C(e.attributes,t),e instanceof u.Z)?e:new u.Z(e);if(e.positions||e.POSITION)return C(e,t),new u.Z({attributes:e});throw Error("Invalid mesh")}class _ extends o.Z{constructor(...e){super(...e),(0,n.Z)(this,"state",void 0)}getShaders(){let e=!(0,h.D0)(this.context.gl),t={};return(0,g.U6)(this.context.gl,p.h.GLSL_DERIVATIVES)&&(t.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n    geometry.worldPosition += pos;\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n    geometry.position = position_commonspace;\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n    geometry.position = position_commonspace;\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n  }\n\n  geometry.normal = normals_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  DECKGL_FILTER_COLOR(color, geometry);\n\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n}\n",modules:[a.Z,l.s,c.Z],transpileToGLSL100:e,defines:t})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let t=this.state.positionBounds;if(t)return t;let{mesh:i}=this.props;if(!i)return null;if(!(t=null===(e=i.header)||void 0===e?void 0:e.boundingBox)){let{attributes:e}=B(i,this.props._useMeshColors);e.POSITION=e.POSITION||e.positions,t=(0,m.v)(e)}return this.state.positionBounds=t,t}initializeState(){let e=this.getAttributeManager();e.addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:A.P}),this.setState({emptyTexture:new d.Z(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);let{props:t,oldProps:i,changeFlags:n}=e;if(t.mesh!==i.mesh||n.extensionsChanged){var r;if(this.state.positionBounds=null,null===(r=this.state.model)||void 0===r||r.delete(),t.mesh){this.state.model=this.getModel(t.mesh);let e=t.mesh.attributes||t.mesh;this.setState({hasNormals:!!(e.NORMAL||e.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==i.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;let{viewport:t}=this.context,{sizeScale:i,coordinateSystem:n,_instanced:r}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!r||(0,A.X)(t,n),flatShading:!this.state.hasNormals}).draw()}getModel(e){let t=new f.Z(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:B(e,this.props._useMeshColors),isInstanced:!0}),{texture:i}=this.props,{emptyTexture:n}=this.state;return t.setUniforms({sampler:i||n,hasTexture:!!i}),t}setTexture(e){let{emptyTexture:t,model:i}=this.state;i&&i.setUniforms({sampler:e||t,hasTexture:!!e})}}(0,n.Z)(_,"defaultProps",{mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}}),(0,n.Z)(_,"layerName","SimpleMeshLayer");var v=i(4088),y=i(8587),b=i(3441);let E=[1],S={...y.Z.defaultProps,elevationData:b.zc,texture:{...b.zc,optional:!0},meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:"",wireframe:!1,material:!0,loaders:[{name:"Terrain",id:"terrain",module:"terrain",version:"3.4.4",worker:!0,extensions:["png","pngraw","jpg","jpeg","gif","webp","bmp"],mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp"],options:{terrain:{tesselator:"auto",bounds:null,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:null}}}]};function M(e){return Array.isArray(e)?e.join(";"):e||""}class I extends r.Z{constructor(...e){super(...e),(0,n.Z)(this,"state",void 0)}updateState({props:e,oldProps:t}){let i=e.elevationData!==t.elevationData;if(i){let{elevationData:t}=e,i=t&&(Array.isArray(t)||t.includes("{x}")&&t.includes("{y}"));this.setState({isTiled:i})}let n=i||e.meshMaxError!==t.meshMaxError||e.elevationDecoder!==t.elevationDecoder||e.bounds!==t.bounds;if(!this.state.isTiled&&n){let t=this.loadTerrain(e);this.setState({terrain:t})}e.workerUrl&&s.Z.removed("workerUrl","loadOptions.terrain.workerUrl")()}loadTerrain({elevationData:e,bounds:t,elevationDecoder:i,meshMaxError:n,signal:r}){var s;if(!e)return null;let o=this.getLoadOptions();o={...o,terrain:{skirtHeight:this.state.isTiled?2*n:0,...null===(s=o)||void 0===s?void 0:s.terrain,bounds:t,meshMaxError:n,elevationDecoder:i}};let{fetch:a}=this.props;return a(e,{propName:"elevationData",layer:this,loadOptions:o,signal:r})}getTiledTerrainData(e){let{elevationData:t,fetch:i,texture:n,elevationDecoder:r,meshMaxError:s}=this.props,{viewport:o}=this.context,a=(0,b.z0)(t,e),l=n&&(0,b.z0)(n,e),{signal:c}=e,u=[0,0],h=[0,0];if(o.isGeospatial){let t=e.bbox;u=o.projectFlat([t.west,t.south]),h=o.projectFlat([t.east,t.north])}else{let t=e.bbox;u=[t.left,t.bottom],h=[t.right,t.top]}let d=[u[0],u[1],h[0],h[1]],f=this.loadTerrain({elevationData:a,bounds:d,elevationDecoder:r,meshMaxError:s,signal:c}),g=l?i(l,{propName:"texture",layer:this,loaders:[],signal:c}).catch(e=>null):Promise.resolve(null);return Promise.all([f,g])}renderSubLayers(e){let t=this.getSubLayerClass("mesh",_),{color:i,wireframe:n,material:r}=this.props,{data:s}=e;if(!s)return null;let[o,a]=s;return new t(e,{data:E,mesh:o,texture:a,_instanced:!1,coordinateSystem:v.Df.CARTESIAN,getPosition:e=>[0,0,0],getColor:i,wireframe:n,material:r})}onViewportLoad(e){if(!e)return;let{zRange:t}=this.state,i=e.map(e=>e.content).filter(Boolean).map(e=>{let t=e[0].header.boundingBox;return t.map(e=>e[2])});if(0===i.length)return;let n=Math.min(...i.map(e=>e[0])),r=Math.max(...i.map(e=>e[1]));(!t||n<t[0]||r>t[1])&&this.setState({zRange:[n,r]})}renderLayers(){let{color:e,material:t,elevationData:i,texture:n,wireframe:r,meshMaxError:s,elevationDecoder:o,tileSize:a,maxZoom:l,minZoom:c,extent:u,maxRequests:h,onTileLoad:d,onTileUnload:f,onTileError:g,maxCacheSize:p,maxCacheByteSize:A,refinementStrategy:m}=this.props;if(this.state.isTiled)return new y.Z(this.getSubLayerProps({id:"tiles"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:M(i),texture:M(n),meshMaxError:s,elevationDecoder:o}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:a,maxZoom:l,minZoom:c,extent:u,maxRequests:h,onTileLoad:d,onTileUnload:f,onTileError:g,maxCacheSize:p,maxCacheByteSize:A,refinementStrategy:m});let C=this.getSubLayerClass("mesh",_);return new C(this.getSubLayerProps({id:"mesh"}),{data:E,mesh:this.state.terrain,texture:n,_instanced:!1,getPosition:e=>[0,0,0],getColor:e,material:t,wireframe:r})}}(0,n.Z)(I,"defaultProps",S),(0,n.Z)(I,"layerName","TerrainLayer")},8587:function(e,t,i){i.d(t,{Z:function(){return eH}});var n=i(1180),r=i(8918),s=i(1855),o=i(3418),a=i(7458),l=i(3844),c=i(9965),u=i(4088),h=i(5462),d=i(3982);let f=[0,0,0,255],g={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:e=>e.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:f},getLineColor:{type:"accessor",value:f},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class p extends a.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[l.Z,c.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var t;let{gl:e}=this.context;null===(t=this.state.model)||void 0===t||t.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){let{radiusUnits:t,radiusScale:i,radiusMinPixels:n,radiusMaxPixels:r,stroked:s,filled:o,billboard:a,antialiasing:l,lineWidthUnits:c,lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:s?1:0,filled:o,billboard:a,antialiasing:l,radiusUnits:u.iI[t],radiusScale:i,radiusMinPixels:n,radiusMaxPixels:r,lineWidthUnits:u.iI[c],lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f}).draw()}_getModel(e){return new h.Z(e,{...this.getShaders(),id:this.props.id,geometry:new d.Z({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}(0,n.Z)(p,"defaultProps",g),(0,n.Z)(p,"layerName","ScatterplotLayer");var A=i(744),m=i(8550);let C=[];class B extends o.Z{constructor(...e){super(...e),(0,n.Z)(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float sdfBuffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState();let e=this.getAttributeManager();e.addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(e,{index:t,target:i})=>this.encodePickingColor(t,i)}})}updateState(e){super.updateState(e);let{props:t,oldProps:i}=e,{outlineColor:n}=t;n!==i.outlineColor&&((n=n.map(e=>e/255))[3]=Number.isFinite(n[3])?n[3]:1,this.setState({outlineColor:n})),!t.sdf&&t.outlineWidth&&A.Z.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){let{sdf:t,smoothing:i,outlineWidth:n}=this.props,{outlineColor:r}=this.state,s=n?Math.max(i,.75*(1-n)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:.75,outlineBuffer:s,gamma:i,sdf:!!t,outlineColor:r},super.draw(e),t&&n){let{iconManager:e}=this.state,t=e.getTexture();t&&this.state.model.draw({uniforms:{outlineBuffer:.75}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(e=>super.getInstanceOffset(e)):C}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(e=>super.getInstanceIconFrame(e)):C}}(0,n.Z)(B,"defaultProps",{getIconOffsets:{type:"accessor",value:e=>e.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),(0,n.Z)(B,"layerName","MultiIconLayer");class _{constructor({fontSize:e=24,buffer:t=3,radius:i=8,cutoff:n=.25,fontFamily:r="sans-serif",fontWeight:s="normal",fontStyle:o="normal"}={}){this.buffer=t,this.cutoff=n,this.radius=i;let a=this.size=e+4*t,l=this._createCanvas(a),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${o} ${s} ${e}px ${r}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(e){let t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){let{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:n,actualBoundingBoxLeft:r,actualBoundingBoxRight:s}=this.ctx.measureText(e),o=Math.ceil(i),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-r))),l=Math.min(this.size-this.buffer,o+Math.ceil(n)),c=a+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),f={data:d,width:c,height:u,glyphWidth:a,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:t};if(0===a||0===l)return f;let{ctx:g,buffer:p,gridInner:A,gridOuter:m}=this;g.clearRect(p,p,a,l),g.fillText(e,p,p+o);let C=g.getImageData(p,p,a,l);m.fill(1e20,0,h),A.fill(0,0,h);for(let e=0;e<l;e++)for(let t=0;t<a;t++){let i=C.data[4*(e*a+t)+3]/255;if(0===i)continue;let n=(e+p)*c+t+p;if(1===i)m[n]=0,A[n]=1e20;else{let e=.5-i;m[n]=e>0?e*e:0,A[n]=e<0?e*e:0}}v(m,0,0,c,u,c,this.f,this.v,this.z),v(A,p,p,a,l,c,this.f,this.v,this.z);for(let e=0;e<h;e++){let t=Math.sqrt(m[e])-Math.sqrt(A[e]);d[e]=Math.round(255-255*(t/this.radius+this.cutoff))}return f}}function v(e,t,i,n,r,s,o,a,l){for(let c=t;c<t+n;c++)y(e,i*s+c,s,r,o,a,l);for(let c=i;c<i+r;c++)y(e,c*s+t,1,n,o,a,l)}function y(e,t,i,n,r,s,o){s[0]=0,o[0]=-1e20,o[1]=1e20,r[0]=e[t];for(let a=1,l=0,c=0;a<n;a++){r[a]=e[t+a*i];let n=a*a;do{let e=s[l];c=(r[a]-r[e]+n-e*e)/(a-e)/2}while(c<=o[l]&&--l>-1);s[++l]=a,o[l]=c,o[l+1]=1e20}for(let a=0,l=0;a<n;a++){for(;o[l+1]<a;)l++;let n=s[l],c=a-n;e[t+a*i]=r[n]+c*c}}let b=[];function E(e,t,i,n){let r=0;for(let o=t;o<i;o++){var s;let t=e[o];r+=(null===(s=n[t])||void 0===s?void 0:s.layoutWidth)||0}return r}function S(e,t,i,n,r,s){let o=t,a=0;for(let l=t;l<i;l++){let t=E(e,l,l+1,r);a+t>n&&(o<l&&s.push(l),o=l,a=0),a+=t}return a}class M{constructor(e=5){(0,n.Z)(this,"limit",void 0),(0,n.Z)(this,"_cache",{}),(0,n.Z)(this,"_order",[]),this.limit=e}get(e){let t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){let t=this._cache[e];t&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){let t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}let I={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){let e=[];for(let t=32;t<128;t++)e.push(String.fromCharCode(t));return e}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},x=new M(3);function P(e,t,i,n){e.font="".concat(n," ").concat(i,"px ").concat(t),e.fillStyle="#000",e.textBaseline="alphabetic",e.textAlign="left"}class R{constructor(){(0,n.Z)(this,"props",{...I}),(0,n.Z)(this,"_key",void 0),(0,n.Z)(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){let{fontSize:e,buffer:t}=this.props;return(1.2*e+2*t)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();let t=function(e,t){let i;i=new Set("string"==typeof t?Array.from(t):t);let n=x.get(e);if(!n)return i;for(let e in n.mapping)i.has(e)&&i.delete(e);return i}(this._key,this.props.characterSet),i=x.get(this._key);if(i&&0===t.size){this._atlas!==i&&(this._atlas=i);return}let n=this._generateFontAtlas(t,i);this._atlas=n,x.set(this._key,n)}_generateFontAtlas(e,t){let{fontFamily:i,fontWeight:n,fontSize:r,buffer:s,sdf:o,radius:a,cutoff:l}=this.props,c=t&&t.data;c||((c=document.createElement("canvas")).width=1024);let u=c.getContext("2d",{willReadFrequently:!0});P(u,i,r,n);let{mapping:h,canvasHeight:d,xOffset:f,yOffset:g}=function({characterSet:e,getFontWidth:t,fontHeight:i,buffer:n,maxCanvasWidth:r,mapping:s={},xOffset:o=0,yOffset:a=0}){let l=0,c=o,u=i+2*n;for(let o of e)if(!s[o]){let e=t(o);c+e+2*n>r&&(c=0,l++),s[o]={x:c+n,y:a+l*u+n,width:e,height:u,layoutWidth:e,layoutHeight:i},c+=e+2*n}return{mapping:s,xOffset:c,yOffset:a+l*u,canvasHeight:Math.pow(2,Math.ceil(Math.log2(a+(l+1)*u)))}}({getFontWidth:e=>u.measureText(e).width,fontHeight:1.2*r,buffer:s,characterSet:e,maxCanvasWidth:1024,...t&&{mapping:t.mapping,xOffset:t.xOffset,yOffset:t.yOffset}});if(c.height!==d){let e=u.getImageData(0,0,c.width,c.height);c.height=d,u.putImageData(e,0,0)}if(P(u,i,r,n),o){let t=new _({fontSize:r,buffer:s,radius:a,cutoff:l,fontFamily:i,fontWeight:"".concat(n)});for(let i of e){let{data:e,width:n,height:s,glyphTop:o}=t.draw(i);h[i].width=n,h[i].layoutOffsetY=.9*r-o;let a=u.createImageData(n,s);!function(e,t){for(let i=0;i<e.length;i++)t.data[4*i+3]=e[i]}(e,a),u.putImageData(a,h[i].x,h[i].y)}}else for(let t of e)u.fillText(t,h[t].x,h[t].y+s+.9*r);return{xOffset:f,yOffset:g,mapping:h,data:c,width:c.width,height:c.height}}_getKey(){let{fontFamily:e,fontWeight:t,fontSize:i,buffer:n,sdf:r,radius:s,cutoff:o}=this.props;return r?"".concat(e," ").concat(t," ").concat(i," ").concat(n," ").concat(s," ").concat(o):"".concat(e," ").concat(t," ").concat(i," ").concat(n)}}let L={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:e=>e.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class T extends a.Z{constructor(...e){super(...e),(0,n.Z)(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[l.Z,c.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);let{changeFlags:t}=e;if(t.extensionsChanged){var i;let{gl:e}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(e),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){let{billboard:t,sizeScale:i,sizeUnits:n,sizeMinPixels:r,sizeMaxPixels:s,getLineWidth:o}=this.props,{padding:a}=this.props;a.length<4&&(a=[a[0],a[1],a[0],a[1]]),this.state.model.setUniforms(e).setUniforms({billboard:t,stroked:!!o,padding:a,sizeUnits:u.iI[n],sizeScale:i,sizeMinPixels:r,sizeMaxPixels:s}).draw()}_getModel(e){return new h.Z(e,{...this.getShaders(),id:this.props.id,geometry:new d.Z({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}(0,n.Z)(T,"defaultProps",L),(0,n.Z)(T,"layerName","TextBackgroundLayer");let F={start:1,middle:0,end:-1},G={top:1,center:0,bottom:-1},D=[0,0,0,255],O={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:D},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:I.characterSet},fontFamily:I.fontFamily,fontWeight:I.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:D},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:e=>e.text},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:D},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class w extends r.Z{constructor(...e){super(...e),(0,n.Z)(this,"state",void 0),(0,n.Z)(this,"getBoundingRect",(e,t)=>{let{size:[i,n]}=this.transformParagraph(e,t),{fontSize:r}=this.state.fontAtlasManager.props;i/=r,n/=r;let{getTextAnchor:s,getAlignmentBaseline:o}=this.props,a=F["function"==typeof s?s(e,t):s],l=G["function"==typeof o?o(e,t):o];return[(a-1)*i/2,(l-1)*n/2,i,n]}),(0,n.Z)(this,"getIconOffsets",(e,t)=>{let{getTextAnchor:i,getAlignmentBaseline:n}=this.props,{x:r,y:s,rowWidth:o,size:[a,l]}=this.transformParagraph(e,t),c=F["function"==typeof i?i(e,t):i],u=G["function"==typeof n?n(e,t):n],h=r.length,d=Array(2*h),f=0;for(let e=0;e<h;e++){let t=(1-c)*(a-o[e])/2;d[f++]=(c-1)*a/2+t+r[e],d[f++]=(u-1)*l/2+s[e]}return d})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new R},this.props.maxWidth>0&&A.Z.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){let{props:t,oldProps:i,changeFlags:n}=e,r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getText);r&&this._updateText();let s=this._updateFontAtlas(),o=s||t.lineHeight!==i.lineHeight||t.wordBreak!==i.wordBreak||t.maxWidth!==i.maxWidth;o&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){let{fontSettings:e,fontFamily:t,fontWeight:i}=this.props,{fontAtlasManager:n,characterSet:r}=this.state,s={...e,characterSet:r,fontFamily:t,fontWeight:i};if(!n.mapping)return n.setProps(s),!0;for(let e in s)if(s[e]!==n.props[e])return n.setProps(s),!0;return!1}_updateText(){var e;let t;let{data:i,characterSet:n}=this.props,r=null===(e=i.attributes)||void 0===e?void 0:e.getText,{getText:s}=this.props,o=i.startIndices,a="auto"===n&&new Set;if(r&&o){let{texts:e,characterCount:n}=function({value:e,length:t,stride:i,offset:n,startIndices:r,characterSet:s}){let o=e.BYTES_PER_ELEMENT,a=i?i/o:1,l=n?n/o:0,c=r[t]||Math.ceil((e.length-l)/a),u=s&&new Set,h=Array(t),d=e;if(a>1||l>0){let t=e.constructor;d=new t(c);for(let t=0;t<c;t++)d[t]=e[t*a+l]}for(let e=0;e<t;e++){let t=r[e],i=r[e+1]||c,n=d.subarray(t,i);h[e]=String.fromCodePoint.apply(null,n),u&&n.forEach(u.add,u)}if(u)for(let e of u)s.add(String.fromCodePoint(e));return{texts:h,characterCount:c}}({...ArrayBuffer.isView(r)?{value:r}:r,length:i.length,startIndices:o,characterSet:a});t=n,s=(t,{index:i})=>e[i]}else{let{iterable:e,objectInfo:n}=(0,m.jB)(i);for(let i of(o=[0],t=0,e)){n.index++;let e=Array.from(s(i,n)||"");a&&e.forEach(a.add,a),t+=e.length,o.push(t)}}this.setState({getText:s,startIndices:o,numInstances:t,characterSet:a||n})}transformParagraph(e,t){let{fontAtlasManager:i}=this.state,n=i.mapping,r=this.state.getText,{wordBreak:s,lineHeight:o,maxWidth:a}=this.props,l=r(e,t)||"";return function(e,t,i,n,r){let s=Array.from(e),o=s.length,a=Array(o),l=Array(o),c=Array(o),u=("break-word"===i||"break-all"===i)&&isFinite(n)&&n>0,h=[0,0],d=[0,0],f=0,g=0,p=0;for(let e=0;e<=o;e++){let C=s[e];if(("\n"===C||e===o)&&(p=e),p>g){let e=u?function(e,t,i,n,r=0,s){void 0===s&&(s=e.length);let o=[];return"break-all"===t?S(e,r,s,i,n,o):function(e,t,i,n,r,s){let o=t,a=t,l=t,c=0;for(let u=t;u<i;u++)if(" "===e[u]?l=u+1:(" "===e[u+1]||u+1===i)&&(l=u+1),l>a){let t=E(e,a,l,r);c+t>n&&(o<a&&(s.push(a),o=a,c=0),t>n&&(t=S(e,a,l,n,r,s),o=s[s.length-1])),a=l,c+=t}return c}(e,r,s,i,n,o),o}(s,i,n,r,g,p):b;for(let i=0;i<=e.length;i++){let n=0===i?g:e[i-1],o=i<e.length?e[i]:p;!function(e,t,i,n,r,s){let o=0,a=0;for(let s=t;s<i;s++){let t=e[s],i=n[t];i?(a||(a=i.layoutHeight),r[s]=o+i.layoutWidth/2,o+=i.layoutWidth):(A.Z.warn("Missing character: ".concat(t," (").concat(t.codePointAt(0),")"))(),r[s]=o,o+=32)}s[0]=o,s[1]=a}(s,n,o,r,a,d);for(let e=n;e<o;e++){var m;let t=s[e],i=(null===(m=r[t])||void 0===m?void 0:m.layoutOffsetY)||0;l[e]=f+d[1]/2+i,c[e]=d[0]}f+=d[1]*t,h[0]=Math.max(h[0],d[0])}g=p}"\n"===C&&(a[g]=0,l[g]=0,c[g]=0,g++)}return h[1]=f,{x:a,y:l,rowWidth:c,size:h}}(l,o,s,a*i.props.fontSize,n)}renderLayers(){let{startIndices:e,numInstances:t,getText:i,fontAtlasManager:{scale:n,texture:r,mapping:s},styleVersion:o}=this.state,{data:a,_dataDiff:l,getPosition:c,getColor:u,getSize:h,getAngle:d,getPixelOffset:f,getBackgroundColor:g,getBorderColor:p,getBorderWidth:A,backgroundPadding:m,background:C,billboard:_,fontSettings:v,outlineWidth:y,outlineColor:b,sizeScale:E,sizeUnits:S,sizeMinPixels:M,sizeMaxPixels:x,transitions:P,updateTriggers:R}=this.props,L=this.getSubLayerClass("characters",B),F=this.getSubLayerClass("background",T);return[C&&new F({getFillColor:g,getLineColor:p,getLineWidth:A,padding:m,getPosition:c,getSize:h,getAngle:d,getPixelOffset:f,billboard:_,sizeScale:E,sizeUnits:S,sizeMinPixels:M,sizeMaxPixels:x,transitions:P&&{getPosition:P.getPosition,getAngle:P.getAngle,getSize:P.getSize,getFillColor:P.getBackgroundColor,getLineColor:P.getBorderColor,getLineWidth:P.getBorderWidth,getPixelOffset:P.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:R.getPosition,getAngle:R.getAngle,getSize:R.getSize,getFillColor:R.getBackgroundColor,getLineColor:R.getBorderColor,getLineWidth:R.getBorderWidth,getPixelOffset:R.getPixelOffset,getBoundingRect:{getText:R.getText,getTextAnchor:R.getTextAnchor,getAlignmentBaseline:R.getAlignmentBaseline,styleVersion:o}}}),{data:a.attributes&&a.attributes.background?{length:a.length,attributes:a.attributes.background}:a,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new L({sdf:v.sdf,smoothing:Number.isFinite(v.smoothing)?v.smoothing:I.smoothing,outlineWidth:y/(v.radius||I.radius),outlineColor:b,iconAtlas:r,iconMapping:s,getPosition:c,getColor:u,getSize:h,getAngle:d,getPixelOffset:f,billboard:_,sizeScale:E*n,sizeUnits:S,sizeMinPixels:M*n,sizeMaxPixels:x*n,transitions:P&&{getPosition:P.getPosition,getAngle:P.getAngle,getColor:P.getColor,getSize:P.getSize,getPixelOffset:P.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:R.getText,getPosition:R.getPosition,getAngle:R.getAngle,getColor:R.getColor,getSize:R.getSize,getPixelOffset:R.getPixelOffset,getIconOffsets:{getTextAnchor:R.getTextAnchor,getAlignmentBaseline:R.getAlignmentBaseline,styleVersion:o}}}),{data:a,_dataDiff:l,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(e){A.Z.assert(Number.isFinite(e)&&e>=3,"Invalid cache limit"),x=new M(e)}}(0,n.Z)(w,"defaultProps",O),(0,n.Z)(w,"layerName","TextLayer");var H=i(1990),U=i(8674),N=i(4211),J=i(6948),Z=i(9187),z=i.n(Z),j=i(9513);let k=j.wG.CLOCKWISE,K=j.wG.COUNTER_CLOCKWISE,V={isClosed:!0};function X(e){return"positions"in e?e.positions:e}function W(e){return"holeIndices"in e?e.holeIndices:null}function Q(e,t,i,n,r){let s=t,o=i.length;for(let t=0;t<o;t++)for(let r=0;r<n;r++)e[s++]=i[t][r]||0;if(!function(e){let t=e[0],i=e[e.length-1];return t[0]===i[0]&&t[1]===i[1]&&t[2]===i[2]}(i))for(let t=0;t<n;t++)e[s++]=i[0][t]||0;return V.start=t,V.end=s,V.size=n,(0,j.Ny)(e,r,V),s}function Y(e,t,i,n,r=0,s,o){s=s||i.length;let a=s-r;if(a<=0)return t;let l=t;for(let t=0;t<a;t++)e[l++]=i[r+t];if(!function(e,t,i,n){for(let r=0;r<t;r++)if(e[i+r]!==e[n-t+r])return!1;return!0}(i,n,r,s))for(let t=0;t<n;t++)e[l++]=i[r+t];return V.start=t,V.end=l,V.size=n,(0,j.Ny)(e,o,V),l}function q(e,t,i){let n=e.length/3,r=0;for(let s=0;s<n;s++){let o=(s+1)%n;r+=e[3*s+t]*e[3*o+i],r-=e[3*o+t]*e[3*s+i]}return Math.abs(r/2)}function $(e,t,i,n){let r=e.length/3;for(let s=0;s<r;s++){let r=3*s,o=e[r+0],a=e[r+1],l=e[r+2];e[r+t]=o,e[r+i]=a,e[r+n]=l}}var ee=i(8005);class et extends ee.Z{constructor(e){let{fp64:t,IndexType:i=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:i,size:1}}})}get(e){let{attributes:t}=this;return"indices"===e?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);let t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){let t=function(e,t){var i;!function(e){if(!Array.isArray(e=e&&e.positions||e)&&!ArrayBuffer.isView(e))throw Error("invalid polygon")}(e);let n=[],r=[];if("positions"in e){let{positions:i,holeIndices:s}=e;if(s){let e=0;for(let o=0;o<=s.length;o++)e=Y(n,e,i,t,s[o-1],s[o],0===o?k:K),r.push(e);return r.pop(),{positions:n,holeIndices:r}}e=i}if(!Array.isArray(e[0]))return Y(n,0,e,t,0,n.length,k),n;if(!((i=e).length>=1&&i[0].length>=2&&Number.isFinite(i[0][0]))){let i=0;for(let[s,o]of e.entries())i=Q(n,i,o,t,0===s?k:K),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return Q(n,0,e,t,k),n}(e,this.positionSize);return this.opts.resolution?(0,j.WZ)(X(t),W(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?(0,j.GU)(X(t),W(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return e}getGeometrySize(e){if(ei(e)){let t=0;for(let i of e)t+=this.getGeometrySize(i);return t}return X(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,t){if(e&&ei(e))for(let i of e){let e=this.getGeometrySize(i);t.geometrySize=e,this.updateGeometryAttributes(i,t),t.vertexStart+=e,t.indexStart=this.indexStarts[t.geometryIndex+1]}else this._updateIndices(e,t),this._updatePositions(e,t),this._updateVertexValid(e,t)}_updateIndices(e,{geometryIndex:t,vertexStart:i,indexStart:n}){let{attributes:r,indexStarts:s,typedArrayManager:o}=this,a=r.indices;if(!a||!e)return;let l=n,c=function(e,t,i,n){let r=W(e);r&&(r=r.map(e=>e/t));let s=X(e),o=n&&3===t;if(i){let e=s.length;s=s.slice();let n=[];for(let r=0;r<e;r+=t){n[0]=s[r],n[1]=s[r+1],o&&(n[2]=s[r+2]);let e=i(n);s[r]=e[0],s[r+1]=e[1],o&&(s[r+2]=e[2])}}if(o){let e=q(s,0,1),t=q(s,0,2),n=q(s,1,2);if(!e&&!t&&!n)return[];e>t&&e>n||(t>n?(i||(s=s.slice()),$(s,0,2,1)):(i||(s=s.slice()),$(s,2,0,1)))}return z()(s,r,t)}(e,this.positionSize,this.opts.preproject,this.opts.full3d);a=o.allocate(a,n+c.length,{copy:!0});for(let e=0;e<c.length;e++)a[l++]=c[e]+i;s[t+1]=n+c.length,r.indices=a}_updatePositions(e,{vertexStart:t,geometrySize:i}){let{attributes:{positions:n},positionSize:r}=this;if(!n||!e)return;let s=X(e);for(let e=t,o=0;o<i;e++,o++){let t=s[o*r],i=s[o*r+1],a=r>2?s[o*r+2]:0;n[3*e]=t,n[3*e+1]=i,n[3*e+2]=a}}_updateVertexValid(e,{vertexStart:t,geometrySize:i}){let{positionSize:n}=this,r=this.attributes.vertexValid,s=e&&W(e);if(e&&e.edgeTypes?r.set(e.edgeTypes,t):r.fill(1,t,t+i),s)for(let e=0;e<s.length;e++)r[t+s[e]/n-1]=0;r[t+i-1]=0}}function ei(e){return Array.isArray(e)&&e.length>0&&!Number.isFinite(e[0])}var en="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",er="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(en,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),es="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(en,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n");let eo=[0,0,0,255],ea={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class el extends a.Z{constructor(...e){super(...e),(0,n.Z)(this,"state",void 0)}getShaders(e){return super.getShaders({vs:"top"===e?er:es,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[l.Z,U.N,c.Z]})}get wrapLongitude(){return!1}initializeState(){let e;let{gl:t,viewport:i}=this.context,{coordinateSystem:n}=this.props,{_full3d:r}=this.props;i.isGeospatial&&n===u.Df.DEFAULT&&(n=u.Df.LNGLAT),n===u.Df.LNGLAT&&(e=r?i.projectPosition.bind(i):i.projectFlat.bind(i)),this.setState({numInstances:0,polygonTesselator:new et({preproject:e,fp64:this.use64bitPositions(),IndexType:!t||(0,N.ag)(t,J.h.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});let s=this.getAttributeManager();s.remove(["instancePickingColors"]),s.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:ea,accessor:"getPolygon",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:!0},elevations:{size:1,transition:ea,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:ea,accessor:"getFillColor",defaultValue:eo,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:ea,accessor:"getLineColor",defaultValue:eo,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(e,{index:t,target:i})=>this.encodePickingColor(e&&e.__source?e.__source.index:t,i),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){let t=super.getPickingInfo(e),{index:i}=t,{data:n}=this.props;return n[0]&&n[0].__source&&(t.object=n.find(e=>e.__source.index===i)),t}disablePickingIndex(e){let{data:t}=this.props;if(t[0]&&t[0].__source)for(let i=0;i<t.length;i++)t[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){let{extruded:t,filled:i,wireframe:n,elevationScale:r}=this.props,{topModel:s,sideModel:o,polygonTesselator:a}=this.state,l={...e,extruded:!!t,elevationScale:r};o&&(o.setInstanceCount(a.instanceCount-1),o.setUniforms(l),n&&(o.setDrawMode(3),o.setUniforms({isWireframe:!0}).draw()),i&&(o.setDrawMode(6),o.setUniforms({isWireframe:!1}).draw())),s&&(s.setVertexCount(a.vertexCount),s.setUniforms(l).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);let{props:t,oldProps:i,changeFlags:n}=e,r=this.getAttributeManager(),s=n.extensionsChanged||t.filled!==i.filled||t.extruded!==i.extruded;if(s){var o;null===(o=this.state.models)||void 0===o||o.forEach(e=>e.delete()),this.setState(this._getModels(this.context.gl)),r.invalidateAll()}}updateGeometry({props:e,oldProps:t,changeFlags:i}){let n=i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon);if(n){let{polygonTesselator:t}=this.state,n=e.data.attributes||{};t.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:n.getPolygon,buffers:n,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged,full3d:e._full3d}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){let t,i;let{id:n,filled:r,extruded:s}=this.props;if(r){let i=this.getShaders("top");i.defines.NON_INSTANCED_MODEL=1,t=new h.Z(e,{...i,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return s&&((i=new h.Z(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new d.Z({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1})).userData.excludeAttributes={indices:!0}),{models:[i,t].filter(Boolean),topModel:t,sideModel:i}}calculateIndices(e){let{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){let{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}(0,n.Z)(el,"defaultProps",{filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:e=>e.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:eo},getLineColor:{type:"accessor",value:eo},material:!0}),(0,n.Z)(el,"layerName","SolidPolygonLayer");let ec={circle:{type:p,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:o.Z,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:w,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},eu={type:H.Z,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},eh={type:el,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function ed({type:e,props:t}){let i={};for(let n in t)i[n]=e.defaultProps[t[n]];return i}function ef(e,t){let{transitions:i,updateTriggers:n}=e.props,r={updateTriggers:{},transitions:i&&{getPosition:i.geometry}};for(let s in t){let o=t[s],a=e.props[s];s.startsWith("get")&&(a=e.getSubLayerAccessor(a),r.updateTriggers[o]=n[s],i&&(r.transitions[o]=i[s])),r[o]=a}return r}function eg(e,t,i={}){let n={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:s=e.length}=i;for(let i=r;i<s;i++){let r=e[i],{geometry:s}=r;if(s){if("GeometryCollection"===s.type){A.Z.assert(Array.isArray(s.geometries),"GeoJSON does not have geometries array");let{geometries:e}=s;for(let s=0;s<e.length;s++){let o=e[s];ep(o,n,t,r,i)}}else ep(s,n,t,r,i)}}return n}function ep(e,t,i,n,r){let{type:s,coordinates:o}=e,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=t;if(!function(e,t){let i=eA[e];for(A.Z.assert(i,"Unknown GeoJSON type ".concat(e));t&&--i>0;)t=t[0];return t&&Number.isFinite(t[0])}(s,o)){A.Z.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":a.push(i({geometry:e},n,r));break;case"MultiPoint":o.forEach(e=>{a.push(i({geometry:{type:"Point",coordinates:e}},n,r))});break;case"LineString":l.push(i({geometry:e},n,r));break;case"MultiLineString":o.forEach(e=>{l.push(i({geometry:{type:"LineString",coordinates:e}},n,r))});break;case"Polygon":c.push(i({geometry:e},n,r)),o.forEach(e=>{u.push(i({geometry:{type:"LineString",coordinates:e}},n,r))});break;case"MultiPolygon":o.forEach(e=>{c.push(i({geometry:{type:"Polygon",coordinates:e}},n,r)),e.forEach(e=>{u.push(i({geometry:{type:"LineString",coordinates:e}},n,r))})})}}let eA={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function em(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function eC(e){return e.geometry.coordinates}let eB=["points","linestrings","polygons"],e_={...ed(ec.circle),...ed(ec.icon),...ed(ec.text),...ed(eu),...ed(eh),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:e=>e.properties.icon},getText:{type:"accessor",value:e=>e.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class ev extends r.Z{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:t}){if(!t.dataChanged)return;let{data:i}=this.props,n=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:n}),n?this._updateStateBinary({props:e,changeFlags:t}):this._updateStateJSON({props:e,changeFlags:t})}_updateStateBinary({props:e,changeFlags:t}){let i=function(e,t){let i=em(),{points:n,lines:r,polygons:s}=e,o=function(e,t){let i={points:null,lines:null,polygons:null};for(let n in i){let r=e[n].globalFeatureIds.value;i[n]=new Uint8ClampedArray(3*r.length);let s=[];for(let e=0;e<r.length;e++)t(r[e],s),i[n][3*e+0]=s[0],i[n][3*e+1]=s[1],i[n][3*e+2]=s[2]}return i}(e,t);return i.points.data={length:n.positions.value.length/n.positions.size,attributes:{...n.attributes,getPosition:n.positions,instancePickingColors:{size:3,value:o.points}},properties:n.properties,numericProps:n.numericProps,featureIds:n.featureIds},i.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:o.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},i.lines._pathType="open",i.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},i.polygons._normalize=!1,s.triangles&&(i.polygons.data.attributes.indices=s.triangles.value),i.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},i.polygonsOutline._pathType="open",i}(e.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON({props:e,changeFlags:t}){let i=function(e){if(Array.isArray(e))return e;switch(A.Z.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return A.Z.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}(e.data),n=this.getSubLayerRow.bind(this),r={},s={};if(Array.isArray(t.dataChanged)){let e=this.state.features;for(let t in e)r[t]=e[t].slice(),s[t]=[];for(let o of t.dataChanged){let t=eg(i,n,o);for(let i in e)s[i].push(function({data:e,getIndex:t,dataRange:i,replace:n}){let{startRow:r=0,endRow:s=1/0}=i,o=e.length,a=o,l=o;for(let i=0;i<o;i++){let n=t(e[i]);if(a>i&&n>=r&&(a=i),n>=s){l=i;break}}let c=a,u=l-a!==n.length,h=u?e.slice(l):void 0;for(let t=0;t<n.length;t++)e[c++]=n[t];if(h){for(let t=0;t<h.length;t++)e[c++]=h[t];e.length=c}return{startRow:a,endRow:a+n.length}}({data:r[i],getIndex:e=>e.__source.index,dataRange:o,replace:t[i]}))}}else r=eg(i,n);let o=function(e,t){let i=em(),{pointFeatures:n,lineFeatures:r,polygonFeatures:s,polygonOutlineFeatures:o}=e;return i.points.data=n,i.points._dataDiff=t.pointFeatures&&(()=>t.pointFeatures),i.points.getPosition=eC,i.lines.data=r,i.lines._dataDiff=t.lineFeatures&&(()=>t.lineFeatures),i.lines.getPath=eC,i.polygons.data=s,i.polygons._dataDiff=t.polygonFeatures&&(()=>t.polygonFeatures),i.polygons.getPolygon=eC,i.polygonsOutline.data=o,i.polygonsOutline._dataDiff=t.polygonOutlineFeatures&&(()=>t.polygonOutlineFeatures),i.polygonsOutline.getPath=eC,i}(r,s);this.setState({features:r,featuresDiff:s,layerProps:o})}getPickingInfo(e){let t=super.getPickingInfo(e),{index:i,sourceLayer:n}=t;return t.featureType=eB.find(e=>n.id.startsWith("".concat(this.id,"-").concat(e,"-"))),i>=0&&n.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[i]),t}_updateAutoHighlight(e){let t="".concat(this.id,"-points-"),i="points"===e.featureType;for(let n of this.getSubLayers())n.id.startsWith(t)===i&&n.updateAutoHighlight(e)}_renderPolygonLayer(){let{extruded:e,wireframe:t}=this.props,{layerProps:i}=this.state,n="polygons-fill",r=this.shouldRenderSubLayer(n,i.polygons.data)&&this.getSubLayerClass(n,eh.type);if(r){let s=ef(this,eh.props),o=e&&t;return o||delete s.getLineColor,s.updateTriggers.lineColors=o,new r(s,this.getSubLayerProps({id:n,updateTriggers:s.updateTriggers}),i.polygons)}return null}_renderLineLayers(){let{extruded:e,stroked:t}=this.props,{layerProps:i}=this.state,n="polygons-stroke",r="linestrings",s=!e&&t&&this.shouldRenderSubLayer(n,i.polygonsOutline.data)&&this.getSubLayerClass(n,eu.type),o=this.shouldRenderSubLayer(r,i.lines.data)&&this.getSubLayerClass(r,eu.type);if(s||o){let e=ef(this,eu.props);return[s&&new s(e,this.getSubLayerProps({id:n,updateTriggers:e.updateTriggers}),i.polygonsOutline),o&&new o(e,this.getSubLayerProps({id:r,updateTriggers:e.updateTriggers}),i.lines)]}return null}_renderPointLayers(){let{pointType:e}=this.props,{layerProps:t,binary:i}=this.state,{highlightedObjectIndex:n}=this.props;!i&&Number.isFinite(n)&&(n=t.points.data.findIndex(e=>e.__source.index===n));let r=new Set(e.split("+")),s=[];for(let e of r){let r="points-".concat(e),o=ec[e],a=o&&this.shouldRenderSubLayer(r,t.points.data)&&this.getSubLayerClass(r,o.type);if(a){let l=ef(this,o.props),c=t.points;if("text"===e&&i){let{instancePickingColors:e,...t}=c.data.attributes;c={...c,data:{...c.data,attributes:t}}}s.push(new a(l,this.getSubLayerProps({id:r,updateTriggers:l.updateTriggers,highlightedObjectIndex:n}),c))}}return s}renderLayers(){let{extruded:e}=this.props,t=this._renderPolygonLayer(),i=this._renderLineLayers(),n=this._renderPointLayers();return[!e&&t,i,n,e&&t]}getSubLayerAccessor(e){let{binary:t}=this.state;return t&&"function"==typeof e?(t,i)=>{let{data:n,index:r}=i,s=function(e,t){if(!e)return null;let i="startIndices"in e?e.startIndices[t]:t,n=e.featureIds.value[i];return -1!==i?function(e,t,i){let n={properties:{...e.properties[t]}};for(let t in e.numericProps)n.properties[t]=e.numericProps[t].value[i];return n}(e,n,i):null}(n,r);return e(s,i)}:super.getSubLayerAccessor(e)}}(0,n.Z)(ev,"layerName","GeoJsonLayer"),(0,n.Z)(ev,"defaultProps",e_);var ey=i(4155);function eb(){let e;if("undefined"!=typeof window&&window.performance)e=window.performance.now();else if(void 0!==ey&&ey.hrtime){let t=ey.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}class eE{constructor(e,t){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=eb(),this._timerPending=!0,this}timeEnd(){return this._timerPending&&(this.addTime(eb()-this._startTime),this._timerPending=!1,this._checkSampling()),this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class eS{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(let e of Object.values(this.stats))e.reset();return this}forEach(e){for(let t of Object.values(this.stats))e(t)}getTable(){let e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach(e=>this._getOrCreate(e))}_getOrCreate(e){let{name:t,type:i}=e,n=this.stats[t];return n||(n=e instanceof eE?e:new eE(t,i),this.stats[t]=n),n}}let eM={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class eI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,n.Z)(this,"props",void 0),(0,n.Z)(this,"stats",void 0),(0,n.Z)(this,"activeRequestCount",0),(0,n.Z)(this,"requestQueue",[]),(0,n.Z)(this,"requestMap",new Map),(0,n.Z)(this,"deferredUpdate",null),this.props={...eM,...e},this.stats=new eS({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);let i={handle:e,priority:0,getPriority:t},n=new Promise(e=>(i.resolve=e,i));return this.requestQueue.push(i),this.requestMap.set(e,n),this._issueNewRequests(),n}_issueRequest(e){let{handle:t,resolve:i}=e,n=!1,r=()=>{n||(n=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,i?i({done:r}):Promise.resolve({done:r})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;let e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(let t=0;t<e;++t){let e=this.requestQueue.shift();e&&this._issueRequest(e)}}}_updateAllRequests(){let e=this.requestQueue;for(let t=0;t<e.length;++t){let i=e[t];!this._updateRequest(i)&&(e.splice(t,1),this.requestMap.delete(i.handle),t--)}e.sort((e,t)=>e.priority-t.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),!(e.priority<0)||(e.resolve(null),!1)}}var ex=i(5451),eP=i(4034);class eR{constructor(e){(0,n.Z)(this,"index",void 0),(0,n.Z)(this,"isVisible",void 0),(0,n.Z)(this,"isSelected",void 0),(0,n.Z)(this,"parent",void 0),(0,n.Z)(this,"children",void 0),(0,n.Z)(this,"content",void 0),(0,n.Z)(this,"state",void 0),(0,n.Z)(this,"layers",void 0),(0,n.Z)(this,"id",void 0),(0,n.Z)(this,"zoom",void 0),(0,n.Z)(this,"userData",void 0),(0,n.Z)(this,"boundingBox",void 0),(0,n.Z)(this,"_abortController",void 0),(0,n.Z)(this,"_loader",void 0),(0,n.Z)(this,"_loaderId",void 0),(0,n.Z)(this,"_isLoaded",void 0),(0,n.Z)(this,"_isCancelled",void 0),(0,n.Z)(this,"_needsReload",void 0),(0,n.Z)(this,"_bbox",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){let e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:t,onLoad:i,onError:n}){let r;let{index:s,id:o,bbox:a,userData:l,zoom:c}=this,u=this._loaderId;this._abortController=new AbortController;let{signal:h}=this._abortController,d=await t.scheduleRequest(this,e=>e.isSelected?1:-1);if(!d){this._isCancelled=!0;return}if(this._isCancelled){d.done();return}let f=null;try{f=await e({index:s,id:o,bbox:a,userData:l,zoom:c,signal:h})}catch(e){r=e||!0}finally{d.done()}if(u===this._loaderId){if(this._loader=void 0,this.content=f,this._isCancelled&&!f){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,r?n(r,this):i(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,null===(e=this._abortController)||void 0===e||e.abort())}}var eL=i(3441);let eT="best-available",eF={[eT]:function(e){for(let t of e)t.state=0;for(let t of e)t.isSelected&&!eD(t)&&eO(t);for(let t of e)t.isVisible=!!(2&t.state)},"no-overlap":function(e){for(let t of e)t.state=0;for(let t of e)t.isSelected&&eD(t);let t=Array.from(e).sort((e,t)=>e.zoom-t.zoom);for(let e of t)if(e.isVisible=!!(2&e.state),e.children&&(e.isVisible||1&e.state))for(let t of e.children)t.state=1;else e.isSelected&&eO(e)},never:()=>{}},eG={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};function eD(e){let t=e;for(;t;){if(t.isLoaded||t.content)return t.state|=2,!0;t=t.parent}return!1}function eO(e){for(let t of e.children)t.isLoaded||t.content?t.state|=2:eO(t)}let ew={TilesetClass:class{constructor(e){var t;let i,r;(0,n.Z)(this,"opts",void 0),(0,n.Z)(this,"_requestScheduler",void 0),(0,n.Z)(this,"_cache",void 0),(0,n.Z)(this,"_dirty",void 0),(0,n.Z)(this,"_tiles",void 0),(0,n.Z)(this,"_cacheByteSize",void 0),(0,n.Z)(this,"_viewport",void 0),(0,n.Z)(this,"_zRange",void 0),(0,n.Z)(this,"_selectedTiles",void 0),(0,n.Z)(this,"_frameNumber",void 0),(0,n.Z)(this,"_modelMatrix",void 0),(0,n.Z)(this,"_modelMatrixInverse",void 0),(0,n.Z)(this,"_maxZoom",void 0),(0,n.Z)(this,"_minZoom",void 0),(0,n.Z)(this,"onTileLoad",void 0),(0,n.Z)(this,"_getCullBounds",(t=eL.XT,r={},e=>{for(let n in e)if(!function(e,t){if(e===t)return!0;if(Array.isArray(e)){let i=e.length;if(!t||t.length!==i)return!1;for(let n=0;n<i;n++)if(e[n]!==t[n])return!1;return!0}return!1}(e[n],r[n])){i=t(e),r=e;break}return i})),this.opts={...eG,...e},this.onTileLoad=e=>{var t,i;null===(t=(i=this.opts).onTileLoad)||void 0===t||t.call(i,e),this.opts.maxCacheByteSize&&(this._cacheByteSize+=e.byteLength,this._resizeCache())},this._requestScheduler=new eI({maxRequests:e.maxRequests,throttleRequests:!!(e.maxRequests&&e.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new ex.Z,this._modelMatrixInverse=new ex.Z,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return null!==this._selectedTiles&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return null!==this._selectedTiles&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(let e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(let e of this._cache.keys()){let t=this._cache.get(e);this._selectedTiles&&this._selectedTiles.includes(t)?t.setNeedsReload():this._cache.delete(e)}}update(e,{zRange:t,modelMatrix:i}={}){let n=new ex.Z(i),r=!n.equals(this._modelMatrix);if(this._viewport&&e.equals(this._viewport)&&(0,eP.fS)(this._zRange,t)&&!r)this.needsReload&&(this._selectedTiles=this._selectedTiles.map(e=>this._getTile(e.index,!0)));else{r&&(this._modelMatrixInverse=n.clone().invert(),this._modelMatrix=n),this._viewport=e,this._zRange=t;let i=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:t,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=i.map(e=>this._getTile(e,!0)),this._dirty&&this._rebuildTree()}let s=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),s&&this._frameNumber++,this._frameNumber}isTileVisible(e,t){if(!e.isVisible)return!1;if(t&&this._viewport){let i=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:t}),{bbox:n}=e;for(let[e,t,r,s]of i){let i;if("west"in n)i=n.west<r&&n.east>e&&n.south<s&&n.north>t;else{let o=Math.min(n.top,n.bottom),a=Math.max(n.top,n.bottom);i=n.left<r&&n.right>e&&o<s&&a>t}if(i)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:t,minZoom:i,zRange:n,modelMatrix:r,modelMatrixInverse:s}){let{tileSize:o,extent:a,zoomOffset:l}=this.opts;return(0,eL.rJ)({viewport:e,maxZoom:t,minZoom:i,zRange:n,tileSize:o,extent:a,modelMatrix:r,modelMatrixInverse:s,zoomOffset:l})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){let{tileSize:t}=this.opts;return{bbox:(0,eL.z_)(this._viewport,e.x,e.y,e.z,t)}}getParentIndex(e){let t=Math.floor(e.x/2),i=Math.floor(e.y/2),n=e.z-1;return{x:t,y:i,z:n}}updateTileStates(){let e=this.opts.refinementStrategy||eT,t=Array(this._cache.size),i=0;for(let e of this._cache.values())t[i++]=e.isVisible,e.isSelected=!1,e.isVisible=!1;for(let e of this._selectedTiles)e.isSelected=!0,e.isVisible=!0;for(let n of(("function"==typeof e?e:eF[e])(Array.from(this._cache.values())),i=0,this._cache.values()))if(t[i++]!==n.isVisible)return!0;return!1}_pruneRequests(){let{maxRequests:e=0}=this.opts,t=[],i=0;for(let e of this._cache.values())!e.isLoading||(i++,e.isSelected||e.isVisible||t.push(e));for(;e>0&&i>e&&t.length>0;){let e=t.shift();e.abort(),i--}}_rebuildTree(){let{_cache:e}=this;for(let t of e.values())t.parent=null,t.children&&(t.children.length=0);for(let t of e.values()){let e=this._getNearestAncestor(t);t.parent=e,null!=e&&e.children&&e.children.push(t)}}_resizeCache(){let{_cache:e,opts:t}=this,i=t.maxCacheSize||(t.maxCacheByteSize?1/0:5*this.selectedTiles.length),n=t.maxCacheByteSize||1/0,r=e.size>i||this._cacheByteSize>n;if(r){for(let[r,a]of e){if(!a.isVisible&&!a.isSelected){var s,o;this._cacheByteSize-=t.maxCacheByteSize?a.byteLength:0,e.delete(r),null===(s=(o=this.opts).onTileUnload)||void 0===s||s.call(o,a)}if(e.size<=i&&this._cacheByteSize<=n)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((e,t)=>e.zoom-t.zoom),this._dirty=!1)}_getTile(e,t){let i=this.getTileId(e),n=this._cache.get(i),r=!1;return!n&&t?(Object.assign(n=new eR(e),this.getTileMetadata(n.index)),Object.assign(n,{id:i,zoom:this.getTileZoom(n.index)}),r=!0,this._cache.set(i,n),this._dirty=!0):n&&n.needsReload&&(r=!0),n&&r&&n.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),n}_getNearestAncestor(e){let{_minZoom:t=0}=this,i=e.index;for(;this.getTileZoom(i)>t;){i=this.getParentIndex(i);let e=this._getTile(i);if(e)return e}return null}},data:{type:"data",value:[]},dataComparator:eL.zc.equal,renderSubLayers:{type:"function",value:e=>new ev(e)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:e=>{}},onTileUnload:{type:"function",value:e=>{}},onTileError:{type:"function",value:e=>console.error(e)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:eT,zRange:null,maxRequests:6,zoomOffset:0};class eH extends r.Z{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,t;null===(e=this.state)||void 0===e||null===(t=e.tileset)||void 0===t||t.finalize()}get isLoaded(){var e,t;return null===(e=this.state)||void 0===e?void 0:null===(t=e.tileset)||void 0===t?void 0:t.selectedTiles.every(e=>e.isLoaded&&e.layers&&e.layers.every(e=>e.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:t}=this.state,i=e.propsOrDataChanged||e.updateTriggersChanged,n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);t?i&&(t.setOptions(this._getTilesetOptions()),n?t.reloadAll():this.state.tileset.tiles.forEach(e=>{e.layers=null})):(t=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:t})),this._updateTileset()}_getTilesetOptions(){let{tileSize:e,maxCacheSize:t,maxCacheByteSize:i,refinementStrategy:n,extent:r,maxZoom:s,minZoom:o,maxRequests:a,zoomOffset:l}=this.props;return{maxCacheSize:t,maxCacheByteSize:i,maxZoom:s,minZoom:o,tileSize:e,refinementStrategy:n,extent:r,maxRequests:a,zoomOffset:l,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){let{tileset:e}=this.state,{zRange:t,modelMatrix:i}=this.props,n=e.update(this.context.viewport,{zRange:t,modelMatrix:i}),{isLoaded:r}=e,s=this.state.isLoaded!==r,o=this.state.frameNumber!==n;r&&(s||o)&&this._onViewportLoad(),o&&this.setState({frameNumber:n}),this.state.isLoaded=r}_onViewportLoad(){let{tileset:e}=this.state,{onViewportLoad:t}=this.props;t&&t(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,t){this.props.onTileError(e),t.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){let{data:t,getTileData:i,fetch:n}=this.props,{signal:r}=e;return(e.url="string"==typeof t||Array.isArray(t)?(0,eL.z0)(t,e):null,i)?i(e):n&&e.url?n(e.url,{propName:"data",layer:this,signal:r}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:t}){let i=t.props.tile;return e.picked&&(e.tile=i),e.sourceTile=i,e}_updateAutoHighlight(e){let t=e.sourceTile;if(t&&t.layers)for(let i of t.layers)i.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{let t=this.getSubLayerPropsByTile(e);if(e.isLoaded||e.content){if(e.layers)t&&e.layers[0]&&Object.keys(t).some(i=>e.layers[0].props[i]!==t[i])&&(e.layers=e.layers.map(e=>e.clone(t)));else{let i=this.renderSubLayers({...this.props,id:"".concat(this.id,"-").concat(e.id),data:e.content,_offset:0,tile:e});e.layers=(0,s.x)(i,Boolean).map(i=>i.clone({tile:e,...t}))}}return e.layers})}filterSubLayer({layer:e,cullRect:t}){let{tile:i}=e.props;return this.state.tileset.isTileVisible(i,t)}}(0,n.Z)(eH,"defaultProps",ew),(0,n.Z)(eH,"layerName","TileLayer")},3441:function(e,t,i){i.d(t,{XT:function(){return ef},rJ:function(){return eC},z0:function(){return ed},hG:function(){return ep},z_:function(){return em},zc:function(){return eu}});var n=i(1180),r=i(5451),s=i(7013),o=i(4088),a=i(7160),l=i(8333);let c=Math.PI/180,u=180/Math.PI;class h extends s.Z{constructor(e={}){let{latitude:t=0,longitude:i=0,zoom:s=0,nearZMultiplier:o=.1,farZMultiplier:a=2,resolution:l=10}=e,{height:u,altitude:h=1.5}=e;u=u||1,h=Math.max(.75,h);let d=new r.Z().lookAt({eye:[0,-h,0],up:[0,0,1]}),f=Math.pow(2,s);d.rotateX(t*c),d.rotateZ(-i*c),d.scale(f/u);let g=Math.atan(.5/h),p=512*f/u;super({...e,height:u,viewMatrix:d,longitude:i,latitude:t,zoom:s,distanceScales:function(){let e=Math.PI/180*256;return{unitsPerMeter:[4018225162502676e-20,4018225162502676e-20,4018225162502676e-20],unitsPerMeter2:[0,0,0],metersPerUnit:[24886.609375,24886.609375,24886.609375],unitsPerDegree:[e,e,4018225162502676e-20],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,24886.609375]}}(),fovyRadians:2*g,focalDistance:h,near:o,far:Math.min(2,1/p+1)*h*a}),(0,n.Z)(this,"longitude",void 0),(0,n.Z)(this,"latitude",void 0),(0,n.Z)(this,"resolution",void 0),this.latitude=t,this.longitude=i,this.resolution=l}get projectionMode(){return o.zG.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){let t={targetZ:e.z||0},i=this.unproject([0,this.height/2],t),n=this.unproject([this.width/2,0],t),r=this.unproject([this.width,this.height/2],t),s=this.unproject([this.width/2,this.height],t);return r[0]<this.longitude&&(r[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],r[0],n[0],s[0]),Math.min(i[1],r[1],n[1],s[1]),Math.max(i[0],r[0],n[0],s[0]),Math.max(i[1],r[1],n[1],s[1])]}unproject(e,{topLeft:t=!0,targetZ:i}={}){let n;let[r,s,o]=e,l=t?s:this.height-s,{pixelUnprojectionMatrix:c}=this;if(Number.isFinite(o))n=d(c,[r,l,o,1]);else{let e=d(c,[r,l,-1,1]),t=d(c,[r,l,1,1]),s=((i||0)/6370972+1)*256,o=a.x9(a.lu([],e,t)),u=a.x9(e),h=a.x9(t),f=(4*u*h-(o-u-h)**2)/16,g=4*f/o,p=(Math.sqrt(u-g)-Math.sqrt(Math.max(0,s*s-g)))/Math.sqrt(o);n=a.t7([],e,t,p)}let[u,h,f]=this.unprojectPosition(n);return Number.isFinite(o)?[u,h,f]:Number.isFinite(i)?[u,h,i]:[u,h]}projectPosition(e){let[t,i,n=0]=e,r=t*c,s=i*c,o=Math.cos(s),a=(n/6370972+1)*256;return[Math.sin(r)*o*a,-Math.cos(r)*o*a,Math.sin(s)*a]}unprojectPosition(e){let[t,i,n]=e,r=a.Zh(e);return[Math.atan2(t,-i)*u,Math.asin(n/r)*u,(r/256-1)*6370972]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,t){let i=this.unproject(t);return{longitude:e[0]-i[0]+this.longitude,latitude:e[1]-i[1]+this.latitude}}}function d(e,t){let i=l.fF([],t,e);return l.bA(i,i,1/i[3]),i}var f=i(6935);let g={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};var p=i(3494);let A=new p.Z,m=new p.Z;class C{constructor(e=[0,0,0],t=[0,0,0],i){(0,n.Z)(this,"center",void 0),(0,n.Z)(this,"halfDiagonal",void 0),(0,n.Z)(this,"minimum",void 0),(0,n.Z)(this,"maximum",void 0),i=i||A.copy(e).add(t).scale(.5),this.center=new p.Z(i),this.halfDiagonal=new p.Z(t).subtract(this.center),this.minimum=new p.Z(e),this.maximum=new p.Z(t)}clone(){return new C(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){let{halfDiagonal:t}=this,i=m.from(e.normal),n=t.x*Math.abs(i.x)+t.y*Math.abs(i.y)+t.z*Math.abs(i.z),r=this.center.dot(i)+e.distance;return r-n>0?g.INSIDE:r+n<0?g.OUTSIDE:g.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){let t;let i=A.from(e).subtract(this.center),{halfDiagonal:n}=this,r=0;return(t=Math.abs(i.x)-n.x)>0&&(r+=t*t),(t=Math.abs(i.y)-n.y)>0&&(r+=t*t),(t=Math.abs(i.z)-n.z)>0&&(r+=t*t),r}}var B=i(5975);let _=new p.Z,v=new p.Z;class y{constructor(e=[0,0,0],t=0){(0,n.Z)(this,"center",void 0),(0,n.Z)(this,"radius",void 0),this.radius=-0,this.center=new p.Z,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=_.from(t),this.center=new p.Z().from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new y(this.center,this.radius)}union(e){let t=this.center,i=this.radius,n=e.center,r=e.radius,s=_.copy(n).subtract(t),o=s.magnitude();if(i>=o+r)return this.clone();if(r>=o+i)return e.clone();let a=(i+o+r)*.5;return v.copy(s).scale((-i+a)/o).add(t),this.center.copy(v),this.radius=a,this}expand(e){let t=_.from(e),i=t.subtract(this.center).magnitude();return i>this.radius&&(this.radius=i),this}transform(e){this.center.transform(e);let t=B.Q$(_,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){let t=this.distanceTo(e);return t*t}distanceTo(e){let t=_.from(e),i=t.subtract(this.center);return Math.max(0,i.len()-this.radius)}intersectPlane(e){let t=this.center,i=this.radius,n=e.normal,r=n.dot(t)+e.distance;return r<-i?g.OUTSIDE:r<i?g.INTERSECTING:g.INSIDE}}var b=i(540),E=i(9108);let S=new p.Z,M=new p.Z,I=new p.Z,x=new p.Z,P=new p.Z,R=new p.Z,L=new p.Z,T={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class F{constructor(e=[0,0,0],t=[0,0,0,0,0,0,0,0,0]){(0,n.Z)(this,"center",void 0),(0,n.Z)(this,"halfAxes",void 0),this.center=new p.Z().from(e),this.halfAxes=new b.Z(t)}get halfSize(){let e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new p.Z(e).len(),new p.Z(t).len(),new p.Z(i).len()]}get quaternion(){let e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),n=new p.Z(e).normalize(),r=new p.Z(t).normalize(),s=new p.Z(i).normalize();return new E.Z().fromMatrix3(new b.Z([...n,...r,...s]))}fromCenterHalfSizeQuaternion(e,t,i){let n=new E.Z(i),r=new b.Z().fromQuaternion(n);return r[0]=r[0]*t[0],r[1]=r[1]*t[0],r[2]=r[2]*t[0],r[3]=r[3]*t[1],r[4]=r[4]*t[1],r[5]=r[5]*t[1],r[6]=r[6]*t[2],r[7]=r[7]*t[2],r[8]=r[8]*t[2],this.center=new p.Z().from(e),this.halfAxes=r,this}clone(){return new F(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new y){let t=this.halfAxes,i=t.getColumn(0,I),n=t.getColumn(1,x),r=t.getColumn(2,P),s=S.copy(i).add(n).add(r);return e.center.copy(this.center),e.radius=s.magnitude(),e}intersectPlane(e){let t=this.center,i=e.normal,n=this.halfAxes,r=i.x,s=i.y,o=i.z,a=Math.abs(r*n[T.COLUMN0ROW0]+s*n[T.COLUMN0ROW1]+o*n[T.COLUMN0ROW2])+Math.abs(r*n[T.COLUMN1ROW0]+s*n[T.COLUMN1ROW1]+o*n[T.COLUMN1ROW2])+Math.abs(r*n[T.COLUMN2ROW0]+s*n[T.COLUMN2ROW1]+o*n[T.COLUMN2ROW2]),l=i.dot(t)+e.distance;return l<=-a?g.OUTSIDE:l>=a?g.INSIDE:g.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){let t;let i=M.from(e).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,I),s=n.getColumn(1,x),o=n.getColumn(2,P),a=r.magnitude(),l=s.magnitude(),c=o.magnitude();r.normalize(),s.normalize(),o.normalize();let u=0;return(t=Math.abs(i.dot(r))-a)>0&&(u+=t*t),(t=Math.abs(i.dot(s))-l)>0&&(u+=t*t),(t=Math.abs(i.dot(o))-c)>0&&(u+=t*t),u}computePlaneDistances(e,t,i=[-0,-0]){let n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=this.center,o=this.halfAxes,a=o.getColumn(0,I),l=o.getColumn(1,x),c=o.getColumn(2,P),u=R.copy(a).add(l).add(c).add(s),h=L.copy(u).subtract(e),d=t.dot(h);return n=Math.min(d,n),r=Math.max(d,r),u.copy(s).add(a).add(l).subtract(c),h.copy(u).subtract(e),n=Math.min(d=t.dot(h),n),r=Math.max(d,r),u.copy(s).add(a).subtract(l).add(c),h.copy(u).subtract(e),n=Math.min(d=t.dot(h),n),r=Math.max(d,r),u.copy(s).add(a).subtract(l).subtract(c),h.copy(u).subtract(e),n=Math.min(d=t.dot(h),n),r=Math.max(d,r),s.copy(u).subtract(a).add(l).add(c),h.copy(u).subtract(e),n=Math.min(d=t.dot(h),n),r=Math.max(d,r),s.copy(u).subtract(a).add(l).subtract(c),h.copy(u).subtract(e),n=Math.min(d=t.dot(h),n),r=Math.max(d,r),s.copy(u).subtract(a).subtract(l).add(c),h.copy(u).subtract(e),n=Math.min(d=t.dot(h),n),r=Math.max(d,r),s.copy(u).subtract(a).subtract(l).subtract(c),h.copy(u).subtract(e),n=Math.min(d=t.dot(h),n),r=Math.max(d,r),i[0]=n,i[1]=r,i}transform(e){this.center.transformAsPoint(e);let t=this.halfAxes.getColumn(0,I);t.transformAsPoint(e);let i=this.halfAxes.getColumn(1,x);i.transformAsPoint(e);let n=this.halfAxes.getColumn(2,P);return n.transformAsPoint(e),this.halfAxes=new b.Z([...t,...i,...n]),this}getTransform(){throw Error("not implemented")}}var G=i(394),D=i(4034);let O=new p.Z,w=new p.Z;class H{constructor(e=[0,0,1],t=0){(0,n.Z)(this,"normal",void 0),(0,n.Z)(this,"distance",void 0),this.normal=new p.Z,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return(0,G.Z)(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=O.from(e),this.normal.from(t).normalize();let i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,t,i,n){return this.normal.set(e,t,i),(0,G.Z)((0,D.fS)(this.normal.len(),1)),this.distance=n,this}clone(){return new H(this.normal,this.distance)}equals(e){return(0,D.fS)(this.distance,e.distance)&&(0,D.fS)(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){let t=w.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,t)}projectPointOntoPlane(e,t=[0,0,0]){e=O.from(e);let i=this.getPointDistance(e),n=w.copy(this.normal).scale(i);return e.subtract(n).to(t)}}let U=[new p.Z([1,0,0]),new p.Z([0,1,0]),new p.Z([0,0,1])],N=new p.Z,J=new p.Z;new H(new p.Z(1,0,0),0);class Z{constructor(e=[]){(0,n.Z)(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*U.length;let t=e.center,i=e.radius,n=0;for(let e of U){let r=this.planes[n],s=this.planes[n+1];r||(r=this.planes[n]=new H),s||(s=this.planes[n+1]=new H);let o=N.copy(e).scale(-i).add(t);e.dot(o),r.fromPointNormal(o,e);let a=N.copy(e).scale(i).add(t),l=J.copy(e).negate();l.dot(a),s.fromPointNormal(a,l),n+=2}return this}computeVisibility(e){let t=g.INSIDE;for(let i of this.planes){let n=e.intersectPlane(i);switch(n){case g.OUTSIDE:return g.OUTSIDE;case g.INTERSECTING:t=g.INTERSECTING}}return t}computeVisibilityWithPlaneMask(e,t){if((0,G.Z)(Number.isFinite(t),"parentPlaneMask is required."),t===Z.MASK_OUTSIDE||t===Z.MASK_INSIDE)return t;let i=Z.MASK_INSIDE,n=this.planes;for(let r=0;r<this.planes.length;++r){let s=r<31?1<<r:0;if(r<31&&(t&s)==0)continue;let o=n[r],a=e.intersectPlane(o);if(a===g.OUTSIDE)return Z.MASK_OUTSIDE;a===g.INTERSECTING&&(i|=s)}return i}}(0,n.Z)(Z,"MASK_OUTSIDE",4294967295),(0,n.Z)(Z,"MASK_INSIDE",0),(0,n.Z)(Z,"MASK_INDETERMINATE",2147483647),new p.Z,new p.Z,new p.Z,new p.Z,new p.Z,new p.Z,new p.Z,new p.Z,new p.Z,new p.Z,new p.Z,new p.Z,new p.Z,new p.Z,new p.Z,new p.Z,new p.Z;var z={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI};let j=new b.Z,k=new b.Z,K=new b.Z,V=new b.Z,X=new b.Z,W=[1,0,0],Q=[2,2,1],Y=new p.Z,q=new p.Z,$=new p.Z,ee=new p.Z,et=new p.Z,ei=new b.Z,en={diagonal:new b.Z,unitary:new b.Z};var er=i(8866);let es=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],eo=es.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),ea=eo.concat([[.25,.5],[.75,.5]]);class el{constructor(e,t,i){(0,n.Z)(this,"x",void 0),(0,n.Z)(this,"y",void 0),(0,n.Z)(this,"z",void 0),(0,n.Z)(this,"childVisible",void 0),(0,n.Z)(this,"selected",void 0),(0,n.Z)(this,"_children",void 0),this.x=e,this.y=t,this.z=i}get children(){if(!this._children){let e=2*this.x,t=2*this.y,i=this.z+1;this._children=[new el(e,t,i),new el(e,t+1,i),new el(e+1,t,i),new el(e+1,t+1,i)]}return this._children}update(e){let{viewport:t,cullingVolume:i,elevationBounds:n,minZ:r,maxZ:s,bounds:o,offset:a,project:l}=e,c=this.getBoundingVolume(n,a,l);if(o&&!this.insideBounds(o))return!1;let u=i.computeVisibility(c);if(u<0)return!1;if(!this.childVisible){let{z:e}=this;if(e<s&&e>=r){let i=c.distanceTo(t.cameraPosition)*t.scale/t.height;e+=Math.floor(Math.log2(i))}if(e>=s)return this.selected=!0,!0}for(let t of(this.selected=!1,this.childVisible=!0,this.children))t.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(let t of this._children)t.getSelected(e);return e}insideBounds([e,t,i,n]){let r=Math.pow(2,this.z),s=512/r;return this.x*s<i&&this.y*s<n&&(this.x+1)*s>e&&(this.y+1)*s>t}getBoundingVolume(e,t,i){if(i){let t=this.z<1?ea:this.z<2?eo:es,n=[];for(let r of t){let t=ep(this.x+r[0],this.y+r[1],this.z);t[2]=e[0],n.push(i(t)),e[0]!==e[1]&&(t[2]=e[1],n.push(i(t)))}return function(e,t=new F){if(!e||0===e.length)return t.halfAxes=new b.Z([0,0,0,0,0,0,0,0,0]),t.center=new p.Z,t;let i=e.length,n=new p.Z(0,0,0);for(let t of e)n.add(t);let r=1/i;n.multiplyByScalar(r);let s=0,o=0,a=0,l=0,c=0,u=0;for(let t of e){let e=Y.copy(t).subtract(n);s+=e.x*e.x,o+=e.x*e.y,a+=e.x*e.z,l+=e.y*e.y,c+=e.y*e.z,u+=e.z*e.z}s*=r,o*=r,a*=r,l*=r,c*=r,u*=r,ei[0]=s,ei[1]=o,ei[2]=a,ei[3]=o,ei[4]=l,ei[5]=c,ei[6]=a,ei[7]=c,ei[8]=u;let{unitary:h}=function(e,t={}){let i=z.EPSILON20,n=0,r=0;k.identity(),K.copy(e);let s=i*function(e){let t=0;for(let i=0;i<9;++i){let n=e[i];t+=n*n}return Math.sqrt(t)}(K);for(;r<10&&function(e){let t=0;for(let i=0;i<3;++i){let n=e[j.getElementIndex(Q[i],W[i])];t+=2*n*n}return Math.sqrt(t)}(K)>s;)(function(e,t){let i=z.EPSILON15,n=0,r=1;for(let t=0;t<3;++t){let i=Math.abs(e[j.getElementIndex(Q[t],W[t])]);i>n&&(r=t,n=i)}let s=W[r],o=Q[r],a=1,l=0;if(Math.abs(e[j.getElementIndex(o,s)])>i){let t;let i=e[j.getElementIndex(o,o)],n=e[j.getElementIndex(s,s)],r=e[j.getElementIndex(o,s)],c=(i-n)/2/r;a=1/Math.sqrt(1+(t=c<0?-1/(-c+Math.sqrt(1+c*c)):1/(c+Math.sqrt(1+c*c)))*t),l=t*a}b.Z.IDENTITY.to(t),t[j.getElementIndex(s,s)]=t[j.getElementIndex(o,o)]=a,t[j.getElementIndex(o,s)]=l,t[j.getElementIndex(s,o)]=-l})(K,V),X.copy(V).transpose(),K.multiplyRight(V),K.multiplyLeft(X),k.multiplyRight(V),++n>2&&(++r,n=0);return t.unitary=k.toTarget(t.unitary),t.diagonal=K.toTarget(t.diagonal),t}(ei,en),d=t.halfAxes.copy(h),f=d.getColumn(0,$),g=d.getColumn(1,ee),A=d.getColumn(2,et),m=-Number.MAX_VALUE,C=-Number.MAX_VALUE,B=-Number.MAX_VALUE,_=Number.MAX_VALUE,v=Number.MAX_VALUE,y=Number.MAX_VALUE;for(let t of e)Y.copy(t),m=Math.max(Y.dot(f),m),C=Math.max(Y.dot(g),C),B=Math.max(Y.dot(A),B),_=Math.min(Y.dot(f),_),v=Math.min(Y.dot(g),v),y=Math.min(Y.dot(A),y);f=f.multiplyByScalar(.5*(_+m)),g=g.multiplyByScalar(.5*(v+C)),A=A.multiplyByScalar(.5*(y+B)),t.center.copy(f).add(g).add(A);let E=q.set(m-_,C-v,B-y).multiplyByScalar(.5),S=new b.Z([E[0],0,0,0,E[1],0,0,0,E[2]]);return t.halfAxes.multiplyRight(S),t}(n)}let n=Math.pow(2,this.z),r=512/n,s=this.x*r+512*t,o=512-(this.y+1)*r;return new C([s,o,e[0]],[s+r,o+r,e[1]])}}let ec=[-1/0,-1/0,1/0,1/0],eu={type:"object",value:null,validate:(e,t)=>t.optional&&null===e||"string"==typeof e||Array.isArray(e)&&e.every(e=>"string"==typeof e),equal:(e,t)=>{if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;let i=e.length;if(i!==t.length)return!1;for(let n=0;n<i;n++)if(e[n]!==t[n])return!1;return!0}};function eh(e,t){let i=[t.transformAsPoint([e[0],e[1]]),t.transformAsPoint([e[2],e[1]]),t.transformAsPoint([e[0],e[3]]),t.transformAsPoint([e[2],e[3]])],n=[Math.min(...i.map(e=>e[0])),Math.min(...i.map(e=>e[1])),Math.max(...i.map(e=>e[0])),Math.max(...i.map(e=>e[1]))];return n}function ed(e,t){if(!e||!e.length)return null;let{index:i,id:n}=t;if(Array.isArray(e)){let t=Math.abs(n.split("").reduce((e,t)=>(e<<5)-e+t.charCodeAt(0)|0,0))%e.length;e=e[t]}let r=e;for(let e of Object.keys(i)){let t=RegExp("{".concat(e,"}"),"g");r=r.replace(t,String(i[e]))}return Number.isInteger(i.y)&&Number.isInteger(i.z)&&(r=r.replace(/\{-y\}/g,String(Math.pow(2,i.z)-i.y-1))),r}function ef({viewport:e,z:t=0,cullRect:i}){let n=e.subViewports||[e];return n.map(e=>(function e(t,i,n){if(!Array.isArray(i)){let e=n.x-t.x,r=n.y-t.y,{width:s,height:o}=n,a={targetZ:i},l=t.unproject([e,r],a),c=t.unproject([e+s,r],a),u=t.unproject([e,r+o],a),h=t.unproject([e+s,r+o],a);return[Math.min(l[0],c[0],u[0],h[0]),Math.min(l[1],c[1],u[1],h[1]),Math.max(l[0],c[0],u[0],h[0]),Math.max(l[1],c[1],u[1],h[1])]}let r=e(t,i[0],n),s=e(t,i[1],n);return[Math.min(r[0],s[0]),Math.min(r[1],s[1]),Math.max(r[2],s[2]),Math.max(r[3],s[3])]})(e,t,i))}function eg(e,t){return 512*Math.pow(2,e)/t}function ep(e,t,i){let n=eg(i,512),r=Math.PI-2*Math.PI*t/n;return[e/n*360-180,180/Math.PI*Math.atan(.5*(Math.exp(r)-Math.exp(-r)))]}function eA(e,t,i,n){let r=eg(i,n);return[e/r*512,t/r*512]}function em(e,t,i,n,r=512){if(e.isGeospatial){let[e,r]=ep(t,i,n),[s,o]=ep(t+1,i+1,n);return{west:e,north:r,east:s,south:o}}let[s,o]=eA(t,i,n,r),[a,l]=eA(t+1,i+1,n,r);return{left:s,top:o,right:a,bottom:l}}function eC({viewport:e,maxZoom:t,minZoom:i,zRange:n,extent:r,tileSize:s=512,modelMatrix:o,modelMatrixInverse:a,zoomOffset:l=0}){let c=e.isGeospatial?Math.round(e.zoom+Math.log2(512/s))+l:Math.ceil(e.zoom)+l;if("number"==typeof i&&Number.isFinite(i)&&c<i){if(!r)return[];c=i}"number"==typeof t&&Number.isFinite(t)&&c>t&&(c=t);let u=r;return o&&a&&r&&!e.isGeospatial&&(u=eh(r,o)),e.isGeospatial?function(e,t,i,n){let r=e instanceof h&&e.resolution?e.projectPosition:null,s=Object.values(e.getFrustumPlanes()).map(({normal:e,distance:t})=>new H(e.clone().negate(),t)),o=new Z(s),a=e.distanceScales.unitsPerMeter[2],l=i&&i[0]*a||0,c=i&&i[1]*a||0,u=e instanceof f.Z&&e.pitch<=60?t:0;if(n){let[e,t,i,r]=n,s=(0,er.w5)([e,r]),o=(0,er.w5)([i,t]);n=[s[0],512-s[1],o[0],512-o[1]]}let d=new el(0,0,0),g={viewport:e,project:r,cullingVolume:o,elevationBounds:[l,c],minZ:u,maxZ:t,bounds:n,offset:0};if(d.update(g),e instanceof f.Z&&e.subViewports&&e.subViewports.length>1){for(g.offset=-1;d.update(g)&&!(--g.offset<-3););for(g.offset=1;d.update(g)&&!(++g.offset>3););}return d.getSelected()}(e,c,n,r):function(e,t,i,n,r){let s=function(e,t,i){let n;if(t&&2===t.length){let[i,r]=t,s=e.getBounds({z:i}),o=e.getBounds({z:r});n=[Math.min(s[0],o[0]),Math.min(s[1],o[1]),Math.max(s[2],o[2]),Math.max(s[3],o[3])]}else n=e.getBounds();return e.isGeospatial?[Math.max(n[0],i[0]),Math.max(n[1],i[1]),Math.min(n[2],i[2]),Math.min(n[3],i[3])]:[Math.max(Math.min(n[0],i[2]),i[0]),Math.max(Math.min(n[1],i[3]),i[1]),Math.min(Math.max(n[2],i[0]),i[2]),Math.min(Math.max(n[3],i[1]),i[3])]}(e,null,n),o=eg(t,i),[a,l,c,u]=function(e,t,i){if(i){let n=eh(e,i).map(e=>e*t/512);return n}return e.map(e=>e*t/512)}(s,o,r),h=[];for(let e=Math.floor(a);e<c;e++)for(let i=Math.floor(l);i<u;i++)h.push({x:e,y:i,z:t});return h}(e,c,s,u||ec,a)}},3863:function(e,t,i){i.d(t,{Z:function(){return A}});var n=i(1180),r=i(4088),s=i(7458),o=i(3844),a=i(9965),l=i(5462),c=i(3982),u=i(8866),h=i(4034);let d=new Uint16Array([0,2,1,0,3,2]),f=new Float32Array([0,1,0,0,1,0,1,1]);var g="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  if (transparentColor.a == 0.0) {\n    return vec4(color, alpha);\n  }\n  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);\n  float highLightRatio = alpha / blendedAlpha;\n  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);\n  return vec4(blendedRGB, blendedAlpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat("\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n","\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive && !picking_uAttribute) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n");let p={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:r.Df.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class A extends s.Z{constructor(...e){super(...e),(0,n.Z)(this,"state",void 0)}getShaders(){return super.getShaders({vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:g,modules:[o.Z,a.Z]})}initializeState(){let e=this.getAttributeManager();e.remove(["instancePickingColors"]),e.add({indices:{size:1,isIndexed:!0,update:e=>e.value=this.state.mesh.indices,noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:e=>e.value=this.state.mesh.positions,noAlloc:!0},texCoords:{size:2,update:e=>e.value=this.state.mesh.texCoords,noAlloc:!0}})}updateState({props:e,oldProps:t,changeFlags:i}){let n=this.getAttributeManager();if(i.extensionsChanged){var r;let{gl:e}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(e),n.invalidateAll()}if(e.bounds!==t.bounds){let e=this.state.mesh,t=this._createMesh();for(let i in this.state.model.setVertexCount(t.vertexCount),t)e&&e[i]!==t[i]&&n.invalidate(i);this.setState({mesh:t,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==t._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){let{image:t}=this.props,i=e.info;if(!i.color||!t)return i.bitmap=null,i;let{width:n,height:r}=t;i.index=0;let s=function(e){let[t,i,n]=e;return[(t+(15&n)/16)/256,(i+(240&n)/256)/256]}(i.color),o=[Math.floor(s[0]*n),Math.floor(s[1]*r)];return i.bitmap={size:{width:n,height:r},uv:s,pixel:o},i}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){let{bounds:e}=this.props,t=e;return m(e)&&(t=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),function(e,t){if(!t)return function(e){let t=new Float64Array(12);for(let i=0;i<e.length;i++)t[3*i+0]=e[i][0],t[3*i+1]=e[i][1],t[3*i+2]=e[i][2]||0;return{vertexCount:6,positions:t,indices:d,texCoords:f}}(e);let i=Math.max(Math.abs(e[0][0]-e[3][0]),Math.abs(e[1][0]-e[2][0])),n=Math.max(Math.abs(e[1][1]-e[0][1]),Math.abs(e[2][1]-e[3][1])),r=Math.ceil(i/t)+1,s=Math.ceil(n/t)+1,o=(r-1)*(s-1)*6,a=new Uint32Array(o),l=new Float32Array(r*s*2),c=new Float64Array(r*s*3),u=0,g=0;for(let t=0;t<r;t++){let i=t/(r-1);for(let n=0;n<s;n++){let r=n/(s-1),o=(0,h.t7)((0,h.t7)(e[0],e[1],r),(0,h.t7)(e[3],e[2],r),i);c[3*u+0]=o[0],c[3*u+1]=o[1],c[3*u+2]=o[2]||0,l[2*u+0]=i,l[2*u+1]=1-r,t>0&&n>0&&(a[g++]=u-s,a[g++]=u-s-1,a[g++]=u-1,a[g++]=u-s,a[g++]=u-1,a[g++]=u),u++}}return{vertexCount:o,positions:c,indices:a,texCoords:l}}(t,this.context.viewport.resolution)}_getModel(e){return e?new l.Z(e,{...this.getShaders(),id:this.props.id,geometry:new c.Z({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){let{uniforms:t,moduleParameters:i}=e,{model:n,coordinateConversion:r,bounds:s,disablePicking:o}=this.state,{image:a,desaturate:l,transparentColor:c,tintColor:u}=this.props;(!i.pickingActive||!o)&&a&&n&&n.setUniforms(t).setUniforms({bitmapTexture:a,desaturate:l,transparentColor:c.map(e=>e/255),tintColor:u.slice(0,3).map(e=>e/255),coordinateConversion:r,bounds:s}).draw()}_getCoordinateUniforms(){let{LNGLAT:e,CARTESIAN:t,DEFAULT:i}=r.Df,{_imageCoordinateSystem:n}=this.props;if(n!==i){let{bounds:i}=this.props;if(!m(i))throw Error("_imageCoordinateSystem only supports rectangular bounds");let r=this.context.viewport.resolution?e:t;if((n=n===e?e:t)===e&&r===t)return{coordinateConversion:-1,bounds:i};if(n===t&&r===e){let e=(0,u.w5)([i[0],i[1]]),t=(0,u.w5)([i[2],i[3]]);return{coordinateConversion:1,bounds:[e[0],e[1],t[0],t[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}function m(e){return Number.isFinite(e[0])}(0,n.Z)(A,"layerName","BitmapLayer"),(0,n.Z)(A,"defaultProps",p)},3418:function(e,t,i){i.d(t,{Z:function(){return y}});var n=i(1180),r=i(7458),s=i(3844),o=i(9965),a=i(4088),l=i(744),c=i(5462),u=i(3982),h=i(1621),d=i(9295),f=i(257),g=i(8550);let p=()=>{},A={10241:9987,10240:9729,10242:33071,10243:33071};function m(e){return e&&(e.id||e.url)}function C(e,t,i){for(let n=0;n<t.length;n++){let{icon:r,xOffset:s}=t[n],o=m(r);e[o]={...r,x:s,y:i}}}class B{constructor(e,{onUpdate:t=p,onError:i=p}){(0,n.Z)(this,"gl",void 0),(0,n.Z)(this,"onUpdate",void 0),(0,n.Z)(this,"onError",void 0),(0,n.Z)(this,"_loadOptions",null),(0,n.Z)(this,"_texture",null),(0,n.Z)(this,"_externalTexture",null),(0,n.Z)(this,"_mapping",{}),(0,n.Z)(this,"_textureParameters",null),(0,n.Z)(this,"_pendingCount",0),(0,n.Z)(this,"_autoPacking",!1),(0,n.Z)(this,"_xOffset",0),(0,n.Z)(this,"_yOffset",0),(0,n.Z)(this,"_rowHeight",0),(0,n.Z)(this,"_buffer",4),(0,n.Z)(this,"_canvasWidth",1024),(0,n.Z)(this,"_canvasHeight",0),(0,n.Z)(this,"_canvas",null),this.gl=e,this.onUpdate=t,this.onError=i}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){let t=this._autoPacking?m(e):e;return this._mapping[t]||{}}setProps({loadOptions:e,autoPacking:t,iconAtlas:i,iconMapping:n,textureParameters:r}){if(e&&(this._loadOptions=e),void 0!==t&&(this._autoPacking=t),n&&(this._mapping=n),i){var s;null===(s=this._texture)||void 0===s||s.delete(),this._texture=null,this._externalTexture=i}r&&(this._textureParameters=r)}get isLoaded(){return 0===this._pendingCount}packIcons(e,t){if(!this._autoPacking||"undefined"==typeof document)return;let i=Object.values(function(e,t,i){if(!e||!t)return null;i=i||{};let n={},{iterable:r,objectInfo:s}=(0,g.jB)(e);for(let e of r){s.index++;let r=t(e,s),o=m(r);if(!r)throw Error("Icon is missing.");if(!r.url)throw Error("Icon url is missing.");n[o]||i[o]&&r.url===i[o].url||(n[o]={...r,source:e,sourceIndex:s.index})}return n}(e,t,this._mapping)||{});if(i.length>0){let{mapping:e,xOffset:t,yOffset:n,rowHeight:r,canvasHeight:s}=function({icons:e,buffer:t,mapping:i={},xOffset:n=0,yOffset:r=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<e.length;l++){let c=e[l],u=m(c);if(!i[u]){let{height:e,width:l}=c;n+l+t>o&&(C(i,a,r),n=0,r=s+r+t,s=0,a=[]),a.push({icon:c,xOffset:n}),n=n+l+t,s=Math.max(s,e)}}return a.length>0&&C(i,a,r),{mapping:i,rowHeight:s,xOffset:n,yOffset:r,canvasWidth:o,canvasHeight:Math.pow(2,Math.ceil(Math.log2(s+r+t)))}}({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=r,this._mapping=e,this._xOffset=t,this._yOffset=n,this._canvasHeight=s,this._texture||(this._texture=new h.Z(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||A})),this._texture.height!==this._canvasHeight&&(this._texture=function(e,t,i,n){let r=e.width,s=e.height,o=new h.Z(e.gl,{width:t,height:i,parameters:n});return(0,d.Lv)(e,o,{targetY:0,width:r,height:s}),e.delete(),o}(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||A)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i)}}_loadIcons(e){let t=this._canvas.getContext("2d",{willReadFrequently:!0});for(let i of e)this._pendingCount++,(0,f.z)(i.url,this._loadOptions).then(e=>{let n=m(i),r=this._mapping[n],{x:s,y:o,width:a,height:l}=r,{data:c,width:u,height:h}=function(e,t,i,n){let r=Math.min(i/t.width,n/t.height),s=Math.floor(t.width*r),o=Math.floor(t.height*r);return 1===r?{data:t,width:s,height:o}:(e.canvas.height=o,e.canvas.width=s,e.clearRect(0,0,s,o),e.drawImage(t,0,0,t.width,t.height,0,0,s,o),{data:e.canvas,width:s,height:o})}(t,e,a,l);this._texture.setSubImageData({data:c,x:s+(a-u)/2,y:o+(l-h)/2,width:u,height:h}),r.width=u,r.height=h,this._texture.generateMipmap(),this.onUpdate()}).catch(e=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:e})}).finally(()=>{this._pendingCount--})}}let _=[0,0,0,255],v={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:e=>e.position},getIcon:{type:"accessor",value:e=>e.icon},getColor:{type:"accessor",value:_},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class y extends r.Z{constructor(...e){super(...e),(0,n.Z)(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[s.Z,o.Z]})}initializeState(){this.state={iconManager:new B(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})};let e=this.getAttributeManager();e.addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:_},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);let{props:t,oldProps:i,changeFlags:n}=e,r=this.getAttributeManager(),{iconAtlas:s,iconMapping:o,data:a,getIcon:l,textureParameters:c}=t,{iconManager:u}=this.state,h=s||this.internalState.isAsyncPropLoading("iconAtlas");if(u.setProps({loadOptions:t.loadOptions,autoPacking:!h,iconAtlas:s,iconMapping:h?o:null,textureParameters:c}),h?i.iconMapping!==t.iconMapping&&r.invalidate("getIcon"):(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getIcon))&&u.packIcons(a,l),n.extensionsChanged){var d;let{gl:e}=this.context;null===(d=this.state.model)||void 0===d||d.delete(),this.state.model=this._getModel(e),r.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){let{sizeScale:t,sizeMinPixels:i,sizeMaxPixels:n,sizeUnits:r,billboard:s,alphaCutoff:o}=this.props,{iconManager:l}=this.state,c=l.getTexture();c&&this.state.model.setUniforms(e).setUniforms({iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeUnits:a.iI[r],sizeScale:t,sizeMinPixels:i,sizeMaxPixels:n,billboard:s,alphaCutoff:o}).draw()}_getModel(e){return new c.Z(e,{...this.getShaders(),id:this.props.id,geometry:new u.Z({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var t;let i=null===(t=this.getCurrentLayer())||void 0===t?void 0:t.props.onIconError;i?i(e):l.Z.error(e.error.message)()}getInstanceOffset(e){let{width:t,height:i,anchorX:n=t/2,anchorY:r=i/2}=this.state.iconManager.getIconMapping(e);return[t/2-n,i/2-r]}getInstanceColorMode(e){let t=this.state.iconManager.getIconMapping(e);return t.mask?1:0}getInstanceIconFrame(e){let{x:t,y:i,width:n,height:r}=this.state.iconManager.getIconMapping(e);return[t,i,n,r]}}(0,n.Z)(y,"defaultProps",v),(0,n.Z)(y,"layerName","IconLayer")},1990:function(e,t,i){i.d(t,{Z:function(){return m}});var n=i(1180),r=i(7458),s=i(3844),o=i(9965),a=i(4088),l=i(5462),c=i(3982),u=i(8005),h=i(9513);class d extends u.Z{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?function(e,t,i,n){let r;if(Array.isArray(e[0])){let i=e.length*t;r=Array(i);for(let i=0;i<e.length;i++)for(let n=0;n<t;n++)r[i*t+n]=e[i][n]||0}else r=e;return i?(0,h.dj)(r,{size:t,gridResolution:i}):n?(0,h.ct)(r,{size:t}):r}(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(f(e)){let t=0;for(let i of e)t+=this.getGeometrySize(i);return t}let t=this.getPathLength(e);return t<2?0:this.isClosed(e)?t<3?0:t+2:t}updateGeometryAttributes(e,t){if(0!==t.geometrySize){if(e&&f(e))for(let i of e){let e=this.getGeometrySize(i);t.geometrySize=e,this.updateGeometryAttributes(i,t),t.vertexStart+=e}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}}_updateSegmentTypes(e,t){let i=this.attributes.segmentTypes,n=!!e&&this.isClosed(e),{vertexStart:r,geometrySize:s}=t;i.fill(0,r,r+s),n?(i[r]=4,i[r+s-2]=4):(i[r]+=1,i[r+s-2]+=2),i[r+s-1]=4}_updatePositions(e,t){let{positions:i}=this.attributes;if(!i||!e)return;let{vertexStart:n,geometrySize:r}=t,s=[,,,];for(let t=n,o=0;o<r;t++,o++)this.getPointOnPath(e,o,s),i[3*t]=s[0],i[3*t+1]=s[1],i[3*t+2]=s[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,t,i=[]){let{positionSize:n}=this;t*n>=e.length&&(t+=1-e.length/n);let r=t*n;return i[0]=e[r],i[1]=e[r+1],i[2]=3===n&&e[r+2]||0,i}isClosed(e){if(!this.normalize)return!!this.opts.loop;let{positionSize:t}=this,i=e.length-t;return e[0]===e[i]&&e[1]===e[i+1]&&(2===t||e[2]===e[i+2])}}function f(e){return Array.isArray(e[0])}let g=[0,0,0,255],p={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:e=>e.path},getColor:{type:"accessor",value:g},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},A={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class m extends r.Z{constructor(...e){super(...e),(0,n.Z)(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\n    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\n    geometry.position = vec4(currPosition + offset, 1.0);\n    gl_Position = project_common_position_to_clipspace(geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[s.Z,o.Z]})}get wrapLongitude(){return!1}initializeState(){let e=this.getAttributeManager();e.addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:A,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:A,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:A,defaultValue:g},instancePickingColors:{size:3,type:5121,accessor:(e,{index:t,target:i})=>this.encodePickingColor(e&&e.__source?e.__source.index:t,i)}}),this.setState({pathTesselator:new d({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);let{props:t,changeFlags:i}=e,n=this.getAttributeManager(),r=i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath);if(r){let{pathTesselator:e}=this.state,r=t.data.attributes||{};e.updateGeometry({data:t.data,geometryBuffer:r.getPath,buffers:r,normalize:!t._pathType,loop:"loop"===t._pathType,getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),i.dataChanged||n.invalidateAll()}if(i.extensionsChanged){var s;let{gl:e}=this.context;null===(s=this.state.model)||void 0===s||s.delete(),this.state.model=this._getModel(e),n.invalidateAll()}}getPickingInfo(e){let t=super.getPickingInfo(e),{index:i}=t,{data:n}=this.props;return n[0]&&n[0].__source&&(t.object=n.find(e=>e.__source.index===i)),t}disablePickingIndex(e){let{data:t}=this.props;if(t[0]&&t[0].__source)for(let i=0;i<t.length;i++)t[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){let{jointRounded:t,capRounded:i,billboard:n,miterLimit:r,widthUnits:s,widthScale:o,widthMinPixels:l,widthMaxPixels:c}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(t),capType:Number(i),billboard:n,widthUnits:a.iI[s],widthScale:o,miterLimit:r,widthMinPixels:l,widthMaxPixels:c}).draw()}_getModel(e){return new l.Z(e,{...this.getShaders(),id:this.props.id,geometry:new c.Z({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(e){let{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){let{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}(0,n.Z)(m,"defaultProps",p),(0,n.Z)(m,"layerName","PathLayer")},4872:function(e,t,i){let n,r,s,o,a,l,c;i.d(t,{Z:function(){return iK}});var u,h,d,f,g,p,A,m,C,B,_,v,y,b,E,S,M,I={};i.r(I),i.d(I,{decode:function(){return to},name:function(){return ts}});var x={};i.r(x),i.d(x,{name:function(){return th},preprocess:function(){return td}});var P={};i.r(P),i.d(P,{name:function(){return tg},preprocess:function(){return tp}});var R={};i.r(R),i.d(R,{decode:function(){return t$},encode:function(){return t0},name:function(){return tY},preprocess:function(){return tq}});var L={};i.r(L),i.d(L,{decode:function(){return it},name:function(){return t6}});var T={};i.r(T),i.d(T,{decode:function(){return io},encode:function(){return ia},name:function(){return is}});var F={};i.r(F),i.d(F,{decode:function(){return iu},encode:function(){return ih},name:function(){return ic}});var G={};i.r(G),i.d(G,{decode:function(){return ip},encode:function(){return iA},name:function(){return ig}});var D={};i.r(D),i.d(D,{decode:function(){return iB},name:function(){return iC}});var O=i(1180),w=i(7458),H=i(3844),U=i(9965),N=i(744),J=i(1418),Z=i(6931);let z={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[Z.H]};var j=i(3494),k=i(5451),K=i(4538),V=i(2525);class X{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{id:t}=e;this.id=t||(0,K.hQ)(this.constructor.name),this.display=!0,this.position=new j.Z,this.rotation=new j.Z,this.scale=new j.Z(1,1,1),this.matrix=new k.Z,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(e){return(0,V.h)(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return(0,V.h)(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return(0,V.h)(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];t?this.matrix.copy(e):this.matrix=e}setMatrixComponents(e){let{position:t,rotation:i,scale:n,update:r=!0}=e;return t&&this.setPosition(t),i&&this.setRotation(i),n&&this.setScale(n),r&&this.updateMatrix(),this}updateMatrix(){let e=this.position,t=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(i),this}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{position:t,rotation:i,scale:n}=e;return t&&this.setPosition(t),i&&this.setRotation(i),n&&this.setScale(n),this.updateMatrix(),this}getCoordinateUniforms(e,t){(0,V.h)(e),t=t||this.matrix;let i=new k.Z(e).multiplyRight(t),n=i.invert(),r=n.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:i,worldInverseMatrix:n,worldInverseTransposeMatrix:r}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}var W=i(3478),Q=i(4072);class Y extends X{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Array.isArray(e)?{children:e}:e;let{children:t=[]}=e;J.cM.assert(t.every(e=>e instanceof X),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];for(let e of t)Array.isArray(e)?this.add(...e):this.children.push(e);return this}remove(e){let t=this.children,i=t.indexOf(e);return i>-1&&t.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}getBounds(){let e=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return(this.traverse((t,i)=>{let{worldMatrix:n}=i,r=t.getBounds();if(!r)return;let[s,o]=r,a=new j.Z(s).add(o).divide([2,2,2]);n.transformAsPoint(a,a);let l=new j.Z(o).subtract(s).divide([2,2,2]);n.transformAsVector(l,l);for(let t=0;t<8;t++){let i=new j.Z(1&t?-1:1,2&t?-1:1,4&t?-1:1).multiply(l).add(a);for(let t=0;t<3;t++)e[0][t]=Math.min(e[0][t],i[t]),e[1][t]=Math.max(e[1][t],i[t])}}),Number.isFinite(e[0][0]))?e:null}traverse(e){let{worldMatrix:t=new k.Z}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=new k.Z(t).multiplyRight(this.matrix);for(let t of this.children)t instanceof Y?t.traverse(e,{worldMatrix:i}):e(t,{worldMatrix:i})}}var q=i(9108);let $={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ee={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function et(e){if(!e._animation){let t=ee[e.componentType],i=$[e.type],n=i*e.count,{buffer:r,byteOffset:s}=e.bufferView.data,o=new t(r,s+(e.byteOffset||0),n);if(1===i)e._animation=Array.from(o);else{let t=[];for(let e=0;e<o.length;e+=i)t.push(Array.from(o.slice(e,e+i)));e._animation=t}}return e._animation}let ei=new k.Z,en=new q.Z;class er{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;let t=(e/1e3-this.startTime)*this.speed;this.channels.forEach(e=>{let{sampler:i,target:n,path:r}=e;!function(e,t,i,n){let{input:r,interpolation:s,output:o}=t,a=r[r.length-1],l=e%a,c=r.findIndex(e=>e>=l),u=Math.max(0,c-1);if(!Array.isArray(i[n]))switch(n){case"translation":i[n]=[0,0,0];break;case"rotation":i[n]=[0,0,0,1];break;case"scale":i[n]=[1,1,1];break;default:J.cM.warn("Bad animation path ".concat(n))()}(0,V.h)(i[n].length===o[u].length);let h=r[u],d=r[c];switch(s){case"STEP":!function(e,t,i){for(let n=0;n<i.length;n++)e[t][n]=i[n]}(i,n,o[u]);break;case"LINEAR":if(d>h){let e=(l-h)/(d-h);!function(e,t,i,n,r){if("rotation"===t){en.slerp({start:i,target:n,ratio:r});for(let i=0;i<en.length;i++)e[t][i]=en[i]}else for(let s=0;s<i.length;s++)e[t][s]=r*n[s]+(1-r)*i[s]}(i,n,o[u],o[c],e)}break;case"CUBICSPLINE":if(d>h){let e=(l-h)/(d-h),t=o[3*u+1],r=o[3*u+2],s=o[3*c+0],a=o[3*c+1];!function(e,t,i){let{p0:n,outTangent0:r,inTangent1:s,p1:o,tDiff:a,ratio:l}=i;for(let i=0;i<e[t].length;i++){let c=r[i]*a,u=s[i]*a;e[t][i]=(2*Math.pow(l,3)-3*Math.pow(l,2)+1)*n[i]+(Math.pow(l,3)-2*Math.pow(l,2)+l)*c+(-2*Math.pow(l,3)+3*Math.pow(l,2))*o[i]+(Math.pow(l,3)-Math.pow(l,2))*u}}(i,n,{p0:t,outTangent0:r,inTangent1:s,p1:a,tDiff:d-h,ratio:e})}break;default:J.cM.warn("Interpolation ".concat(s," not supported"))()}}(t,i,n,r),function(e,t){if(t.matrix.identity(),e.translation&&t.matrix.translate(e.translation),e.rotation){let i=ei.fromQuaternion(e.rotation);t.matrix.multiplyRight(i)}e.scale&&t.matrix.scale(e.scale)}(n,n._node)})}}class es{constructor(e){this.animations=e.animations.map((t,i)=>{let n=t.name||"Animation-".concat(i),r=t.samplers.map(t=>{let{input:i,interpolation:n="LINEAR",output:r}=t;return{input:et(e.accessors[i]),interpolation:n,output:et(e.accessors[r])}}),s=t.channels.map(t=>{let{sampler:i,target:n}=t;return{sampler:r[i],target:e.nodes[n.node],path:n.path}});return new er({name:n,channels:s})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}var eo=i(5462);class ea extends X{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof eo.Z?(this.model=e,this._setModelNodeProps(t)):this.model=new eo.Z(e,t),this.bounds=null,this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(e){this.model.setProps(e)}}var el=i(4211),ec=i(6948),eu=i(1621);class eh{constructor(e,t){let{attributes:i,material:n,pbrDebug:r,imageBasedLightingEnvironment:s,lights:o,useTangents:a}=t;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},(0,el.U6)(e,ec.h.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(i.NORMAL,"HAS_NORMALS"),this.defineIfPresent(i.TANGENT&&a,"HAS_TANGENTS"),this.defineIfPresent(i.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),n&&this.parseMaterial(n)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t){let i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},s=e.texture.source.image,o={};s.compressed?(i=s,o={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):i={data:s};let a=new eu.Z(this.gl,{id:e.name||e.id,parameters:{...r,...o},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...i});this.uniforms[t]=a,this.defineIfPresent(n,n),this.generatedTextures.push(a)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");let{metallicFactor:t=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=!!e.unlit,e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");let{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");let{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){let{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(J.cM.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(e=>e.delete())}}function ed(e,t){return(0,J.D0)(e)?"#version 300 es\n".concat(t):t}let ef={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},eg={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class ep{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.options=Object.assign({},eg,t)}instantiate(e){this.gltf=e;let t=(e.scenes||[]).map(e=>this.createScene(e));return t}createAnimator(){return Array.isArray(this.gltf.animations)?new es(this.gltf):null}createScene(e){let t=e.nodes||[],i=t.map(e=>this.createNode(e)),n=new Y({id:e.name||e.id,children:i});return n}createNode(e){if(!e._node){let t=e.children||[],i=t.map(e=>this.createNode(e));e.mesh&&i.push(this.createMesh(e.mesh));let n=new Y({id:e.name||e.id,children:i});if(e.matrix)n.setMatrix(e.matrix);else{if(n.matrix.identity(),e.translation&&n.matrix.translate(e.translation),e.rotation){let t=new k.Z().fromQuaternion(e.rotation);n.matrix.multiplyRight(t)}e.scale&&n.matrix.scale(e.scale)}e._node=n}return e._node}createMesh(e){if(!e._mesh){let t=e.primitives||[],i=t.map((t,i)=>this.createPrimitive(t,i,e)),n=new Y({id:e.name||e.id,children:i});e._mesh=n}return e._mesh}getVertexCount(e){J.cM.warn("getVertexCount() not found")()}createPrimitive(e,t,i){let n=function(e,t){let{id:i,drawMode:n,vertexCount:r,attributes:s,modelOptions:o}=t,a=new eh(e,t);J.cM.info(4,"createGLTFModel defines: ",a.defines)();let l=[];l.push(...a.generatedTextures),l.push(...Object.values(s).map(e=>e.buffer));let c=new ea(e,Object.assign({id:i,drawMode:n,vertexCount:r,modules:[z],defines:a.defines,parameters:a.parameters,vs:ed(e,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:ed(e,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l},o));return c.setProps({attributes:s}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:e.name||"".concat(i.name||i.id,"-primitive-").concat(t),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options));return n.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],n}createAttributes(e,t){let i={};return Object.keys(e).forEach(t=>{i[t]=this.createAccessor(e[t],this.createBuffer(e[t],this.gl.ARRAY_BUFFER))}),t&&(i.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),J.cM.info(4,"glTF Attributes",{attributes:e,indices:t,generated:i})(),i}createBuffer(e,t){e.bufferView||(e.bufferView={});let{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[t]||(i.lumaBuffers[t]=new W.Z(this.gl,{id:"from-".concat(i.id),data:i.data||e.value,target:t})),i.lumaBuffers[t]}createAccessor(e,t){return new Q.Z({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:ef[e.type]})}createSampler(e){return e}needsPOT(){return!1}}var eA=i(6013),em=i(7180),eC=i(6040);let eB={};async function e_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t&&(e=function(e,t,i){if(e.startsWith("http"))return e;let n=i.modules||{};return n[e]?n[e]:eA.jU?i.CDN?((0,eC.h)(i.CDN.startsWith("http")),"".concat(i.CDN,"/").concat(t,"@").concat("3.4.4","/dist/libs/").concat(e)):eA.hJ?"../src/libs/".concat(e):"modules/".concat(t,"/src/libs/").concat(e):"modules/".concat(t,"/dist/libs/").concat(e)}(e,t,i)),eB[e]=eB[e]||ev(e),await eB[e]}async function ev(e){if(e.endsWith("wasm")){let t=await fetch(e);return await t.arrayBuffer()}if(!eA.jU)try{return em&&em.requireFromFile&&await em.requireFromFile(e)}catch{return null}if(eA.hJ)return importScripts(e);let t=await fetch(e),i=await t.text();return function(e,t){if(!eA.jU)return em.requireFromString&&em.requireFromString(e,t);if(eA.hJ)return eval.call(eA.CO,e),null;let i=document.createElement("script");i.id=t;try{i.appendChild(document.createTextNode(e))}catch(t){i.text=e}return document.body.appendChild(i),null}(i,e)}let ey="3.4.4",eb="https://unpkg.com/@loaders.gl/textures@".concat(ey,"/dist/libs/basis_encoder.wasm"),eE="https://unpkg.com/@loaders.gl/textures@".concat(ey,"/dist/libs/basis_encoder.js");async function eS(e){let t=e.modules||{};return t.basis?t.basis:(n=n||eM(e),await n)}async function eM(e){let t=null,i=null;return[t,i]=await Promise.all([await e_("basis_transcoder.js","textures",e),await e_("basis_transcoder.wasm","textures",e)]),t=t||globalThis.BASIS,await function(e,t){let i={};return t&&(i.wasmBinary=t),new Promise(t=>{e(i).then(e=>{let{BasisFile:i,initializeBasis:n}=e;n(),t({BasisFile:i})})})}(t,i)}async function eI(e){let t=e.modules||{};return t.basisEncoder?t.basisEncoder:(r=r||ex(e),await r)}async function ex(e){let t=null,i=null;return[t,i]=await Promise.all([await e_(eE,"textures",e),await e_(eb,"textures",e)]),t=t||globalThis.BASIS,await function(e,t){let i={};return t&&(i.wasmBinary=t),new Promise(t=>{e(i).then(e=>{let{BasisFile:i,KTX2File:n,initializeBasis:r,BasisEncoder:s}=e;r(),t({BasisFile:i,KTX2File:n,BasisEncoder:s})})})}(t,i)}let eP={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},eR=["","WEBKIT_","MOZ_"],eL={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"},eT=null;i(1876).Buffer,new Uint8Array([0]),(u=B||(B={}))[u.NONE=0]="NONE",u[u.BASISLZ=1]="BASISLZ",u[u.ZSTD=2]="ZSTD",u[u.ZLIB=3]="ZLIB",(h=_||(_={}))[h.BASICFORMAT=0]="BASICFORMAT",(d=v||(v={}))[d.UNSPECIFIED=0]="UNSPECIFIED",d[d.ETC1S=163]="ETC1S",d[d.UASTC=166]="UASTC",(f=y||(y={}))[f.UNSPECIFIED=0]="UNSPECIFIED",f[f.SRGB=1]="SRGB",(g=b||(b={}))[g.UNSPECIFIED=0]="UNSPECIFIED",g[g.LINEAR=1]="LINEAR",g[g.SRGB=2]="SRGB",g[g.ITU=3]="ITU",g[g.NTSC=4]="NTSC",g[g.SLOG=5]="SLOG",g[g.SLOG2=6]="SLOG2",(p=E||(E={}))[p.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",p[p.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED",(A=S||(S={}))[A.RGB=0]="RGB",A[A.RRR=3]="RRR",A[A.GGG=4]="GGG",A[A.AAA=15]="AAA",(m=M||(M={}))[m.RGB=0]="RGB",m[m.RGBA=3]="RGBA",m[m.RRR=4]="RRR",m[m.RRRG=5]="RRRG";let eF=[171,75,84,88,32,50,48,187,13,10,26,10],eG={etc1:{basisFormat:0,compressed:!0,format:eP.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:eP.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:eP.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:eP.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:eP.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:eP.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function eD(e,t){if("auto"===t.basis.containerFormat){if(function(e){let t=new Uint8Array(e),i=t.byteLength<eF.length||t[0]!==eF[0]||t[1]!==eF[1]||t[2]!==eF[2]||t[3]!==eF[3]||t[4]!==eF[4]||t[5]!==eF[5]||t[6]!==eF[6]||t[7]!==eF[7]||t[8]!==eF[8]||t[9]!==eF[9]||t[10]!==eF[10]||t[11]!==eF[11];return!i}(e)){let i=await eI(t);return ew(i.KTX2File,e,t)}let{BasisFile:i}=await eS(t);return eO(i,e,t)}if("encoder"===t.basis.module){let i=await eI(t);return"ktx2"===t.basis.containerFormat?ew(i.KTX2File,e,t):eO(i.BasisFile,e,t)}{let{BasisFile:i}=await eS(t);return eO(i,e,t)}}function eO(e,t,i){let n=new e(new Uint8Array(t));try{if(!n.startTranscoding())throw Error("Failed to start basis transcoding");let e=n.getNumImages(),t=[];for(let r=0;r<e;r++){let e=n.getNumLevels(r),s=[];for(let t=0;t<e;t++)s.push(function(e,t,i,n){let r=e.getImageWidth(t,i),s=e.getImageHeight(t,i),o=e.getHasAlpha(),{compressed:a,format:l,basisFormat:c}=eH(n,o),u=e.getImageTranscodedSizeInBytes(t,i,c),h=new Uint8Array(u);if(!e.transcodeImage(h,t,i,c,0,0))throw Error("failed to start Basis transcoding");return{width:r,height:s,data:h,compressed:a,format:l,hasAlpha:o}}(n,r,t,i));t.push(s)}return t}finally{n.close(),n.delete()}}function ew(e,t,i){let n=new e(new Uint8Array(t));try{if(!n.startTranscoding())throw Error("failed to start KTX2 transcoding");let e=n.getLevels(),t=[];for(let r=0;r<e;r++){t.push(function(e,t,i){let{alphaFlag:n,height:r,width:s}=e.getImageLevelInfo(t,0,0),{compressed:o,format:a,basisFormat:l}=eH(i,n),c=e.getImageTranscodedSizeInBytes(t,0,0,l),u=new Uint8Array(c);if(!e.transcodeImage(u,t,0,0,l,0,-1,-1))throw Error("Failed to transcode KTX2 image");return{width:s,height:r,data:u,compressed:o,levelSize:c,hasAlpha:n,format:a}}(n,r,i));break}return[t]}finally{n.close(),n.delete()}}function eH(e,t){let i=e&&e.basis&&e.basis.format;return"auto"===i&&(i=eU()),"object"==typeof i&&(i=t?i.alpha:i.noAlpha),eG[i=i.toLowerCase()]}function eU(){let e=function(e){if(!eT){for(let t of(e=e||function(){try{let e=document.createElement("canvas");return e.getContext("webgl")}catch(e){return null}}()||void 0,eT=new Set,eR))for(let i in eL)if(e&&e.getExtension("".concat(t).concat(i))){let e=eL[i];eT.add(e)}}return eT}();return e.has("astc")?"astc-4x4":e.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:e.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:e.has("etc1")?"etc1":e.has("etc2")?"etc2":"rgb565"}let eN={name:"Basis",id:eA.jU?"basis":"basis-nodejs",module:"textures",version:"3.4.4",worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},eJ={...eN,parse:eD};var eZ=i(4022);function ez(e,t,i){if(e.byteLength<=t+i)return"";let n=new DataView(e),r="";for(let e=0;e<i;e++)r+=String.fromCharCode(n.getUint8(t+e));return r}var ej=i(4609);function ek(e,t){if(!e)throw Error(t||"assert failed: gltf")}function eK(e,t){let i=e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:");if(i)return e;let n=t.baseUri||t.uri;if(!n)throw Error("'baseUri' must be provided to resolve relative url ".concat(e));return n.substr(0,n.lastIndexOf("/")+1)+e}var eV=i(1949),eX=i(6269);function eW(e,t){return(0,eX.h)(e>=0),(0,eX.h)(t>0),e+(t-1)&~(t-1)}let eQ=["SCALAR","VEC2","VEC3","VEC4"],eY=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],eq=new Map(eY),e$={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},e0={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},e1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function e2(e){let t=eQ[e-1];return t||"SCALAR"}function e9(e){let t=eq.get(e.constructor);if(!t)throw Error("Illegal typed array");return t}function e3(e,t){let i=e1[e.componentType],n=e$[e.type],r=e0[e.componentType],s=e.count*n,o=e.count*n*r;return ek(o>=0&&o<=t.byteLength),{ArrayType:i,length:s,byteLength:o}}let e8={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class e4{constructor(e){(0,O.Z)(this,"gltf",void 0),(0,O.Z)(this,"sourceBuffers",void 0),(0,O.Z)(this,"byteLength",void 0),this.gltf=e||{json:{...e8},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){let t=this.json[e];return t}getExtraData(e){let t=this.json.extras||{};return t[e]}getExtension(e){let t=this.getUsedExtensions().find(t=>t===e),i=this.json.extensions||{};return t?i[e]||!0:null}getRequiredExtension(e){let t=this.getRequiredExtensions().find(t=>t===e);return t?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,t){let i=e.extensions||{};return i[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;let i=this.json[e]&&this.json[e][t];if(!i)throw Error("glTF file error: Could not find ".concat(e,"[").concat(t,"]"));return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);let t=e.buffer,i=this.gltf.buffers[t];ek(i);let n=(e.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,n,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);let t=this.getBufferView(e.bufferView),i=this.getBuffer(t.buffer),n=i.data,{ArrayType:r,length:s}=e3(e,t),o=t.byteOffset+e.byteOffset;return new r(n,o,s)}getTypedArrayForImageData(e){e=this.getAccessor(e);let t=this.getBufferView(e.bufferView),i=this.getBuffer(t.buffer),n=i.data,r=t.byteOffset||0;return new Uint8Array(n,r,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,i){return e.extensions=e.extensions||{},e.extensions[t]=i,this.registerUsedExtension(t),this}setObjectExtension(e,t,i){let n=e.extensions||{};n[t]=i}removeObjectExtension(e,t){let i=e.extensions||{},n=i[t];return delete i[t],n}addExtension(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ek(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ek(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){if(!this.getExtension(e))return;this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);let t=this.json.extensionsRemoved;t.includes(e)||t.push(e)}setDefaultScene(e){this.json.scene=e}addScene(e){let{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){let{meshIndex:t,matrix:i}=e;this.json.nodes=this.json.nodes||[];let n={mesh:t};return i&&(n.matrix=i),this.json.nodes.push(n),this.json.nodes.length-1}addMesh(e){let{attributes:t,indices:i,material:n,mode:r=4}=e,s=this._addAttributes(t),o={primitives:[{attributes:s,mode:r}]};if(i){let e=this._addIndices(i);o.primitives[0].indices=e}return Number.isFinite(n)&&(o.primitives[0].material=n),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1}addPointCloud(e){let t=this._addAttributes(e);return this.json.meshes=this.json.meshes||[],this.json.meshes.push({primitives:[{attributes:t,mode:0}]}),this.json.meshes.length-1}addImage(e,t){let i=(0,eV.I)(e),n=t||(null==i?void 0:i.mimeType),r=this.addBufferView(e);return this.json.images=this.json.images||[],this.json.images.push({bufferView:r,mimeType:n}),this.json.images.length-1}addBufferView(e){let t=e.byteLength;ek(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);let i={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=eW(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,t){let i={bufferView:e,type:e2(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:3},i=this.addBufferView(e),n={min:t.min,max:t.max};n.min&&n.max||(n=this._getAccessorMinMax(e,t.size));let r={size:t.size,componentType:e9(e),count:Math.round(e.length/t.size),min:n.min,max:n.max};return this.addAccessor(i,Object.assign(r,t))}addTexture(e){let{imageIndex:t}=e;return this.json.textures=this.json.textures||[],this.json.textures.push({source:t}),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];let i=this.byteLength,n=new ArrayBuffer(i),r=new Uint8Array(n),s=0;for(let e of this.sourceBuffers||[])s=function(e,t,i){let n;if(e instanceof ArrayBuffer)n=new Uint8Array(e);else{let t=e.byteOffset,i=e.byteLength;n=new Uint8Array(e.buffer||e.arrayBuffer,t,i)}return t.set(n,i),i+eW(n.byteLength,4)}(e,r,s);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=n,this.sourceBuffers=[n]}_removeStringFromArray(e,t){let i=!0;for(;i;){let n=e.indexOf(t);n>-1?e.splice(n,1):i=!1}}_addAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};for(let i in e){let n=e[i],r=this._getGltfAttributeName(i),s=this.addBinaryBuffer(n.value,n);t[r]=s}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){let i={min:null,max:null};if(e.length<t)return i;i.min=[],i.max=[];let n=e.subarray(0,t);for(let e of n)i.min.push(e),i.max.push(e);for(let n=t;n<e.length;n+=t)for(let r=0;r<t;r++)i.min[0+r]=Math.min(i.min[0+r],e[n+r]),i.max[0+r]=Math.max(i.max[0+r],e[n+r]);return i}}let e6=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),e5=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),e7={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},te={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function tt(e,t,i,n,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NONE",o=await ti();!function(e,t,i,n,r,s,o){let a=e.exports.sbrk,l=n+3&-4,c=a(l*r),u=a(s.length),h=new Uint8Array(e.exports.memory.buffer);h.set(s,u);let d=t(c,n,r,u,s.length);if(0===d&&o&&o(c,l,r),i.set(h.subarray(c,c+n*r)),a(c-a(0)),0!==d)throw Error("Malformed buffer data: ".concat(d))}(o,o.exports[te[r]],e,t,i,n,o.exports[e7[s||"NONE"]])}async function ti(){return s||(s=tn()),s}async function tn(){let e="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";WebAssembly.validate(e6)&&(e="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",console.log("Warning: meshopt_decoder is using experimental SIMD support"));let t=await WebAssembly.instantiate(function(e){let t=new Uint8Array(e.length);for(let i=0;i<e.length;++i){let n=e.charCodeAt(i);t[i]=n>96?n-71:n>64?n-65:n>47?n+4:n>46?63:62}let i=0;for(let n=0;n<e.length;++n)t[i++]=t[n]<60?e5[t[n]]:(t[n]-60)*64+t[++n];return t.buffer.slice(0,i)}(e),{});return await t.instance.exports.__wasm_call_ctors(),t.instance}let tr="EXT_meshopt_compression",ts=tr;async function to(e,t){var i;let n=new e4(e);if(!(null!=t&&null!==(i=t.gltf)&&void 0!==i&&i.decompressMeshes))return;let r=[];for(let t of e.json.bufferViews||[])r.push(ta(n,t));await Promise.all(r),n.removeExtension(tr)}async function ta(e,t){let i=e.getObjectExtension(t,tr);if(i){let{byteOffset:n=0,byteLength:r=0,byteStride:s,count:o,mode:a,filter:l="NONE",buffer:c}=i,u=e.gltf.buffers[c],h=new Uint8Array(u.arrayBuffer,u.byteOffset+n,r),d=new Uint8Array(e.gltf.buffers[t.buffer].arrayBuffer,t.byteOffset,t.byteLength);return await tt(d,o,s,h,a,l),d}return null}var tl=i(4959);let tc={},tu="EXT_texture_webp",th=tu;function td(e,t){let i=new e4(e);if(!function(e){if(void 0===tc[e]){let t=tl.jU?function(e){switch(e){case"image/avif":case"image/webp":return function(e){try{let t=document.createElement("canvas"),i=t.toDataURL(e);return 0===i.indexOf("data:".concat(e))}catch{return!1}}(e);default:return!0}}(e):function(e){let{_parseImageNode:t,_imageFormatsNode:i=["image/png","image/jpeg","image/gif"]}=globalThis;return!!t&&i.includes(e)}(e);tc[e]=t}return tc[e]}("image/webp")){if(i.getRequiredExtensions().includes(tu))throw Error("gltf: Required extension ".concat(tu," not supported by browser"));return}let{json:n}=i;for(let e of n.textures||[]){let t=i.getObjectExtension(e,tu);t&&(e.source=t.source),i.removeObjectExtension(e,tu)}i.removeExtension(tu)}let tf="KHR_texture_basisu",tg=tf;function tp(e,t){let i=new e4(e),{json:n}=i;for(let e of n.textures||[]){let t=i.getObjectExtension(e,tf);t&&(e.source=t.source),i.removeObjectExtension(e,tf)}i.removeExtension(tf)}let tA={draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},tm={name:"Draco",id:eA.jU?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:"3.4.4",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:tA};var tC=i(435);class tB{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map;(0,O.Z)(this,"name",void 0),(0,O.Z)(this,"type",void 0),(0,O.Z)(this,"nullable",void 0),(0,O.Z)(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=i,this.metadata=n}get typeId(){return this.type&&this.type.typeId}clone(){return new tB(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let t_=((C={})[C.NONE=0]="NONE",C[C.Null=1]="Null",C[C.Int=2]="Int",C[C.Float=3]="Float",C[C.Binary=4]="Binary",C[C.Utf8=5]="Utf8",C[C.Bool=6]="Bool",C[C.Decimal=7]="Decimal",C[C.Date=8]="Date",C[C.Time=9]="Time",C[C.Timestamp=10]="Timestamp",C[C.Interval=11]="Interval",C[C.List=12]="List",C[C.Struct=13]="Struct",C[C.Union=14]="Union",C[C.FixedSizeBinary=15]="FixedSizeBinary",C[C.FixedSizeList=16]="FixedSizeList",C[C.Map=17]="Map",C[C.Dictionary=-1]="Dictionary",C[C.Int8=-2]="Int8",C[C.Int16=-3]="Int16",C[C.Int32=-4]="Int32",C[C.Int64=-5]="Int64",C[C.Uint8=-6]="Uint8",C[C.Uint16=-7]="Uint16",C[C.Uint32=-8]="Uint32",C[C.Uint64=-9]="Uint64",C[C.Float16=-10]="Float16",C[C.Float32=-11]="Float32",C[C.Float64=-12]="Float64",C[C.DateDay=-13]="DateDay",C[C.DateMillisecond=-14]="DateMillisecond",C[C.TimestampSecond=-15]="TimestampSecond",C[C.TimestampMillisecond=-16]="TimestampMillisecond",C[C.TimestampMicrosecond=-17]="TimestampMicrosecond",C[C.TimestampNanosecond=-18]="TimestampNanosecond",C[C.TimeSecond=-19]="TimeSecond",C[C.TimeMillisecond=-20]="TimeMillisecond",C[C.TimeMicrosecond=-21]="TimeMicrosecond",C[C.TimeNanosecond=-22]="TimeNanosecond",C[C.DenseUnion=-23]="DenseUnion",C[C.SparseUnion=-24]="SparseUnion",C[C.IntervalDayTime=-25]="IntervalDayTime",C[C.IntervalYearMonth=-26]="IntervalYearMonth",C);class tv{static isNull(e){return e&&e.typeId===t_.Null}static isInt(e){return e&&e.typeId===t_.Int}static isFloat(e){return e&&e.typeId===t_.Float}static isBinary(e){return e&&e.typeId===t_.Binary}static isUtf8(e){return e&&e.typeId===t_.Utf8}static isBool(e){return e&&e.typeId===t_.Bool}static isDecimal(e){return e&&e.typeId===t_.Decimal}static isDate(e){return e&&e.typeId===t_.Date}static isTime(e){return e&&e.typeId===t_.Time}static isTimestamp(e){return e&&e.typeId===t_.Timestamp}static isInterval(e){return e&&e.typeId===t_.Interval}static isList(e){return e&&e.typeId===t_.List}static isStruct(e){return e&&e.typeId===t_.Struct}static isUnion(e){return e&&e.typeId===t_.Union}static isFixedSizeBinary(e){return e&&e.typeId===t_.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===t_.FixedSizeList}static isMap(e){return e&&e.typeId===t_.Map}static isDictionary(e){return e&&e.typeId===t_.Dictionary}get typeId(){return t_.NONE}compareTo(e){return this===e}}o=Symbol.toStringTag;class ty extends tv{constructor(e,t){super(),(0,O.Z)(this,"isSigned",void 0),(0,O.Z)(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return t_.Int}get[o](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class tb extends ty{constructor(){super(!0,8)}}class tE extends ty{constructor(){super(!0,16)}}class tS extends ty{constructor(){super(!0,32)}}class tM extends ty{constructor(){super(!1,8)}}class tI extends ty{constructor(){super(!1,16)}}class tx extends ty{constructor(){super(!1,32)}}let tP={HALF:16,SINGLE:32,DOUBLE:64};a=Symbol.toStringTag;class tR extends tv{constructor(e){super(),(0,O.Z)(this,"precision",void 0),this.precision=e}get typeId(){return t_.Float}get[a](){return"Float"}toString(){return"Float".concat(this.precision)}}class tL extends tR{constructor(){super(tP.SINGLE)}}class tT extends tR{constructor(){super(tP.DOUBLE)}}l=Symbol.toStringTag;class tF extends tv{constructor(e,t){super(),(0,O.Z)(this,"listSize",void 0),(0,O.Z)(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return t_.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[l](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}class tG{constructor(e,t){(0,O.Z)(this,"fields",void 0),(0,O.Z)(this,"metadata",void 0),function(e,t){if(!e)throw Error("loader assertion failed.")}(Array.isArray(e)),function(e){let t={};for(let i of e)t[i.name]&&console.warn("Schema: duplicated field name",i.name,i),t[i.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(){let e=Object.create(null);for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];for(let t of i)e[t]=!0;let r=this.fields.filter(t=>e[t.name]);return new tG(r,this.metadata)}selectAt(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let n=t.map(e=>this.fields[e]).filter(Boolean);return new tG(n,this.metadata)}assign(e){let t;let i=this.metadata;e instanceof tG?(t=e.fields,i=tD(tD(new Map,this.metadata),e.metadata)):t=e;let n=Object.create(null);for(let e of this.fields)n[e.name]=e;for(let e of t)n[e.name]=e;let r=Object.values(n);return new tG(r,i)}}function tD(e,t){return new Map([...e||new Map,...t||new Map])}function tO(e,t,i){let n=i?tw(i.metadata):void 0,r=function(e,t,i){let n=function(e){switch(e.constructor){case Int8Array:return new tb;case Uint8Array:return new tM;case Int16Array:return new tE;case Uint16Array:return new tI;case Int32Array:return new tS;case Uint32Array:return new tx;case Float32Array:return new tL;case Float64Array:return new tT;default:throw Error("array type not supported")}}(t.value),r=i||function(e){let t=new Map;return"byteOffset"in e&&t.set("byteOffset",e.byteOffset.toString(10)),"byteStride"in e&&t.set("byteStride",e.byteStride.toString(10)),"normalized"in e&&t.set("normalized",e.normalized.toString()),t}(t),s=new tB(e,new tF(t.size,new tB("value",n)),!1,r);return s}(e,t,n);return r}function tw(e){let t=new Map;for(let i in e)t.set("".concat(i,".string"),JSON.stringify(e[i]));return t}let tH={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},tU={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class tN{constructor(e){(0,O.Z)(this,"draco",void 0),(0,O.Z)(this,"decoder",void 0),(0,O.Z)(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);let n=this.decoder.GetEncodedGeometryType(i),r=n===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let e;switch(n){case this.draco.TRIANGULAR_MESH:e=this.decoder.DecodeBufferToMesh(i,r);break;case this.draco.POINT_CLOUD:e=this.decoder.DecodeBufferToPointCloud(i,r);break;default:throw Error("DRACO: Unknown geometry type.")}if(!e.ok()||!r.ptr){let t="DRACO decompression failed: ".concat(e.error_msg());throw Error(t)}let s=this._getDracoLoaderData(r,n,t),o=this._getMeshData(r,s,t),a=(0,tC.v)(o.attributes),l=function(e,t,i){let n=tw(t.metadata),r=[],s=function(e){let t={};for(let i in e){let n=e[i];t[n.name||"undefined"]=n}return t}(t.attributes);for(let t in e){let i=e[t],n=tO(t,i,s[t]);r.push(n)}if(i){let e=tO("indices",i);r.push(e)}return new tG(r,n)}(o.attributes,s,o.indices),c={loader:"draco",loaderData:s,header:{vertexCount:r.num_points(),boundingBox:a},...o,schema:l};return c}finally{this.draco.destroy(i),r&&this.draco.destroy(r)}}_getDracoLoaderData(e,t,i){let n=this._getTopLevelMetadata(e),r=this._getDracoAttributes(e,i);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:n,attributes:r}}_getDracoAttributes(e,t){let i={};for(let n=0;n<e.num_attributes();n++){let r=this.decoder.GetAttribute(e,n),s=this._getAttributeMetadata(e,n);i[r.unique_id()]={unique_id:r.unique_id(),attribute_type:r.attribute_type(),data_type:r.data_type(),num_components:r.num_components(),byte_offset:r.byte_offset(),byte_stride:r.byte_stride(),normalized:r.normalized(),attribute_index:n,metadata:s};let o=this._getQuantizationTransform(r,t);o&&(i[r.unique_id()].quantization_transform=o);let a=this._getOctahedronTransform(r,t);a&&(i[r.unique_id()].octahedron_transform=a)}return i}_getMeshData(e,t,i){let n=this._getMeshAttributes(t,e,i),r=n.POSITION;if(!r)throw Error("DRACO: No position attribute found.");return e instanceof this.draco.Mesh?"triangle-strip"===i.topology?{topology:"triangle-strip",mode:4,attributes:n,indices:{value:this._getTriangleStripIndices(e),size:1}}:{topology:"triangle-list",mode:5,attributes:n,indices:{value:this._getTriangleListIndices(e),size:1}}:{topology:"point-list",mode:0,attributes:n}}_getMeshAttributes(e,t,i){let n={};for(let r of Object.values(e.attributes)){let e=this._deduceAttributeName(r,i);r.name=e;let{value:s,size:o}=this._getAttributeValues(t,r);n[e]={value:s,size:o,byteOffset:r.byte_offset,byteStride:r.byte_stride,normalized:r.normalized}}return n}_getTriangleListIndices(e){let t=e.num_faces(),i=3*t,n=4*i,r=this.draco._malloc(n);try{return this.decoder.GetTrianglesUInt32Array(e,n,r),new Uint32Array(this.draco.HEAPF32.buffer,r,i).slice()}finally{this.draco._free(r)}}_getTriangleStripIndices(e){let t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(e){let t=e.size(),i=new Int32Array(t);for(let n=0;n<t;n++)i[n]=e.GetValue(n);return i}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){let i;let n=tU[t.data_type],r=t.num_components,s=e.num_points(),o=s*r,a=o*n.BYTES_PER_ELEMENT,l=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32;default:return e.DT_INVALID}}(this.draco,n),c=this.draco._malloc(a);try{let r=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,r,l,a,c),i=new n(this.draco.HEAPF32.buffer,c,o).slice()}finally{this.draco._free(c)}return{value:i,size:r}}_deduceAttributeName(e,t){let i=e.unique_id;for(let[e,n]of Object.entries(t.extraAttributes||{}))if(n===i)return e;let n=e.attribute_type;for(let e in tH){let t=this.draco[e];if(t===n)return tH[e]}let r=t.attributeNameEntry||"name";return e.metadata[r]?e.metadata[r].string:"CUSTOM_ATTRIBUTE_".concat(i)}_getTopLevelMetadata(e){let t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){let i=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};let t={},i=this.metadataQuerier.NumEntries(e);for(let n=0;n<i;n++){let i=this.metadataQuerier.GetEntryName(e,n);t[i]=this._getDracoMetadataField(e,i)}return t}_getDracoMetadataField(e,t){let i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,i);let n=function(e){let t=e.size(),i=new Int32Array(t);for(let n=0;n<t;n++)i[n]=e.GetValue(n);return i}(i);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:n}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){let{quantizedAttributes:t=[],octahedronAttributes:i=[]}=e,n=[...t,...i];for(let e of n)this.decoder.SkipAttributeTransform(this.draco[e])}_getQuantizationTransform(e,t){let{quantizedAttributes:i=[]}=t,n=e.attribute_type(),r=i.map(e=>this.decoder[e]).includes(n);if(r){let t=new this.draco.AttributeQuantizationTransform;try{if(t.InitFromAttribute(e))return{quantization_bits:t.quantization_bits(),range:t.range(),min_values:new Float32Array([1,2,3]).map(e=>t.min_value(e))}}finally{this.draco.destroy(t)}}return null}_getOctahedronTransform(e,t){let{octahedronAttributes:i=[]}=t,n=e.attribute_type(),r=i.map(e=>this.decoder[e]).includes(n);if(r){let t=new this.draco.AttributeQuantizationTransform;try{if(t.InitFromAttribute(e))return{quantization_bits:t.quantization_bits()}}finally{this.draco.destroy(t)}}return null}}let tJ="https://www.gstatic.com/draco/versioned/decoders/".concat("1.5.5"),tZ="".concat(tJ,"/draco_decoder.js"),tz="".concat(tJ,"/draco_wasm_wrapper.js"),tj="".concat(tJ,"/draco_decoder.wasm");async function tk(e){let t=e.modules||{};return c=t.draco3d?c||t.draco3d.createDecoderModule({}).then(e=>({draco:e})):c||tK(e),await c}async function tK(e){let t,i;return"js"===(e.draco&&e.draco.decoderType)?t=await e_(tZ,"draco",e):[t,i]=await Promise.all([await e_(tz,"draco",e),await e_(tj,"draco",e)]),t=t||globalThis.DracoDecoderModule,await function(e,t){let i={};return t&&(i.wasmBinary=t),new Promise(t=>{e({...i,onModuleLoaded:e=>t({draco:e})})})}(t,i)}eA.jU;let tV={...tm,parse:tX};async function tX(e,t){let{draco:i}=await tk(t),n=new tN(i);try{return n.parseSync(e,null==t?void 0:t.draco)}finally{n.destroy()}}function tW(e){let t,i,n;let{buffer:r,size:s,count:o}=(t=e,i=1,n=0,e&&e.value&&(t=e.value,i=e.size||1),t&&(ArrayBuffer.isView(t)||(t=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e?!Array.isArray(e)&&(!i||e instanceof t)?e:new t(e):null}(t,Float32Array)),n=t.length/i),{buffer:t,size:i,count:n}),a={value:r,size:s,byteOffset:0,count:o,type:e2(s),componentType:e9(r)};return a}let tQ="KHR_draco_mesh_compression",tY=tQ;function tq(e,t,i){let n=new e4(e);for(let e of t2(n))n.getObjectExtension(e,tQ)}async function t$(e,t,i){var n;if(!(null!=t&&null!==(n=t.gltf)&&void 0!==n&&n.decompressMeshes))return;let r=new e4(e),s=[];for(let e of t2(r))r.getObjectExtension(e,tQ)&&s.push(t1(r,e,t,i));await Promise.all(s),r.removeExtension(tQ)}function t0(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=new e4(e);for(let e of i.json.meshes||[])(function(e,t){var i;arguments.length>2&&void 0!==arguments[2]&&arguments[2];let n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(!n.DracoWriter)throw Error("options.gltf.DracoWriter not provided");let s=n.DracoWriter.encodeSync({attributes:e}),o=null==r?void 0:null===(i=r.parseSync)||void 0===i?void 0:i.call(r,{attributes:e});n._addFauxAttributes(o.attributes),n.addBufferView(s)})(e,t),i.addRequiredExtension(tQ)}async function t1(e,t,i,n){let r=e.getObjectExtension(t,tQ);if(!r)return;let s=e.getTypedArrayForBufferView(r.bufferView),o=(0,ej.qv)(s.buffer,s.byteOffset),{parse:a}=n,l={...i};delete l["3d-tiles"];let c=await a(o,tV,l,n),u=function(e){let t={};for(let i in e){let n=e[i];if("indices"!==i){let e=tW(n);t[i]=e}}return t}(c.attributes);for(let[i,n]of Object.entries(u))if(i in t.attributes){let r=t.attributes[i],s=e.getAccessor(r);null!=s&&s.min&&null!=s&&s.max&&(n.min=s.min,n.max=s.max)}t.attributes=u,c.indices&&(t.indices=tW(c.indices)),function(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw Error("glTF: Empty primitive detected: Draco decompression failure?")}(t)}function*t2(e){for(let t of e.json.meshes||[])for(let e of t.primitives)yield e}var t9=i(540);let t3={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},t8={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},t4="KHR_texture_transform",t6=t4,t5=new j.Z,t7=new t9.Z,ie=new t9.Z;async function it(e,t){let i=new e4(e),n=i.getExtension(t4);if(!n)return;let r=e.json.materials||[];for(let t=0;t<r.length;t++)!function(e,t){var i,n,r;let s=[],o=null===(i=t.json.materials)||void 0===i?void 0:i[e],a=null==o?void 0:null===(n=o.pbrMetallicRoughness)||void 0===n?void 0:n.baseColorTexture;a&&ii(t,e,a,s);let l=null==o?void 0:o.emissiveTexture;l&&ii(t,e,l,s);let c=null==o?void 0:o.normalTexture;c&&ii(t,e,c,s);let u=null==o?void 0:o.occlusionTexture;u&&ii(t,e,u,s);let h=null==o?void 0:null===(r=o.pbrMetallicRoughness)||void 0===r?void 0:r.metallicRoughnessTexture;h&&ii(t,e,h,s)}(t,e)}function ii(e,t,i,n){let r=function(e,t){var i;let n=null===(i=e.extensions)||void 0===i?void 0:i[t4],{texCoord:r=0}=e,{texCoord:s=r}=n,o=-1!==t.findIndex(e=>{let[t,i]=e;return t===r&&i===s});if(!o){let i=function(e){let{offset:t=[0,0],rotation:i=0,scale:n=[1,1]}=e,r=new t9.Z().set(1,0,0,0,1,0,t[0],t[1],1),s=t7.set(Math.cos(i),Math.sin(i),0,-Math.sin(i),Math.cos(i),0,0,0,1),o=ie.set(n[0],0,0,0,n[1],0,0,0,1);return r.multiplyRight(s).multiplyRight(o)}(n);return r!==s&&(e.texCoord=s),t.push([r,s]),{originalTexCoord:r,texCoord:s,matrix:i}}return null}(i,n);if(!r)return;let s=e.json.meshes||[];for(let i of s)for(let n of i.primitives){let i=n.material;Number.isFinite(i)&&t===i&&function(e,t,i){let{originalTexCoord:n,texCoord:r,matrix:s}=i,o=t.attributes["TEXCOORD_".concat(n)];if(Number.isFinite(o)){var a,l,c;let i=null===(a=e.json.accessors)||void 0===a?void 0:a[o];if(i&&i.bufferView){let o=null===(l=e.json.bufferViews)||void 0===l?void 0:l[i.bufferView];if(o){let{arrayBuffer:a,byteOffset:l}=e.buffers[o.buffer],u=(l||0)+(i.byteOffset||0)+(o.byteOffset||0),{ArrayType:h,length:d}=e3(i,o),f=t8[i.componentType],g=t3[i.type],p=o.byteStride||f*g,A=new Float32Array(d);for(let e=0;e<i.count;e++){let t=new h(a,u+e*p,2);t5.set(t[0],t[1],1),t5.transformByMatrix3(s),A.set([t5[0],t5[1]],e*g)}n===r?(c=e.buffers,i.componentType=5126,c.push({arrayBuffer:A.buffer,byteOffset:0,byteLength:A.buffer.byteLength}),o.buffer=c.length-1,o.byteLength=A.buffer.byteLength,o.byteOffset=0,delete o.byteStride):function(e,t,i,n,r){n.buffers.push({arrayBuffer:r.buffer,byteOffset:0,byteLength:r.buffer.byteLength});let s=n.json.bufferViews;if(!s)return;s.push({buffer:n.buffers.length-1,byteLength:r.buffer.byteLength,byteOffset:0});let o=n.json.accessors;o&&(o.push({bufferView:(null==s?void 0:s.length)-1,byteOffset:0,componentType:5126,count:t.count,type:"VEC2"}),i.attributes["TEXCOORD_".concat(e)]=o.length-1)}(r,i,t,e,A)}}}}(e,n,r)}}let ir="KHR_lights_punctual",is=ir;async function io(e){let t=new e4(e),{json:i}=t,n=t.getExtension(ir);for(let e of(n&&(t.json.lights=n.lights,t.removeExtension(ir)),i.nodes||[])){let i=t.getObjectExtension(e,ir);i&&(e.light=i.light),t.removeObjectExtension(e,ir)}}async function ia(e){let t=new e4(e),{json:i}=t;if(i.lights){let e=t.addExtension(ir);ek(!e.lights),e.lights=i.lights,delete i.lights}if(t.json.lights){for(let e of t.json.lights){let i=e.node;t.addObjectExtension(i,ir,e)}delete t.json.lights}}let il="KHR_materials_unlit",ic=il;async function iu(e){let t=new e4(e),{json:i}=t;for(let e of i.materials||[]){let i=e.extensions&&e.extensions.KHR_materials_unlit;i&&(e.unlit=!0),t.removeObjectExtension(e,il)}t.removeExtension(il)}function ih(e){let t=new e4(e),{json:i}=t;if(t.materials)for(let e of i.materials||[])e.unlit&&(delete e.unlit,t.addObjectExtension(e,il,{}),t.addExtension(il))}let id="KHR_techniques_webgl",ig=id;async function ip(e){let t=new e4(e),{json:i}=t,n=t.getExtension(id);if(n){let e=function(e,t){let{programs:i=[],shaders:n=[],techniques:r=[]}=e,s=new TextDecoder;return n.forEach(e=>{if(Number.isFinite(e.bufferView))e.code=s.decode(t.getTypedArrayForBufferView(e.bufferView));else throw Error("KHR_techniques_webgl: no shader code")}),i.forEach(e=>{e.fragmentShader=n[e.fragmentShader],e.vertexShader=n[e.vertexShader]}),r.forEach(e=>{e.program=i[e.program]}),r}(n,t);for(let n of i.materials||[]){let i=t.getObjectExtension(n,id);i&&(n.technique=Object.assign({},i,e[i.technique]),n.technique.values=function(e,t){let i=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach(t=>{!e.uniforms[t].value||t in i||(i[t]=e.uniforms[t].value)}),Object.keys(i).forEach(e=>{"object"==typeof i[e]&&void 0!==i[e].index&&(i[e].texture=t.getTexture(i[e].index))}),i}(n.technique,t)),t.removeObjectExtension(n,id)}t.removeExtension(id)}}async function iA(e,t){}let im="EXT_feature_metadata",iC=im;async function iB(e){let t=new e4(e);!function(e){var t;let i=e.getExtension(im),n=null==i?void 0:null===(t=i.schema)||void 0===t?void 0:t.classes,r=null==i?void 0:i.featureTables,s=null==i?void 0:i.featureTextures;if(s&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),n&&r)for(let t in n){let i=n[t],s=function(e,t){for(let i in e){let n=e[i];if(n.class===t)return n}return null}(r,t);s&&function(e,t,i){for(let r in i.properties){var n;let s=i.properties[r],o=null==t?void 0:null===(n=t.properties)||void 0===n?void 0:n[r],a=t.count;if(o){let t=function(e,t,i,n){let r=n.bufferView,s=e.getTypedArrayForBufferView(r);if("STRING"===t.type){let t=n.stringOffsetBufferView,r=e.getTypedArrayForBufferView(t);s=function(e,t,i){let n=[],r=new TextDecoder("utf8"),s=0;for(let o=0;o<i;o++){let i=t[(o+1)*4]-t[4*o],a=e.subarray(s,i+s),l=r.decode(a);n.push(l),s+=i}return n}(s,r,i)}return s}(e,s,a,o);o.data=t}}}(e,s,i)}}(t)}let i_=[I,x,P,R,T,F,G,L,D];async function iv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,n=i_.filter(e=>iy(e.name,t));for(let s of n){var r;await (null===(r=s.decode)||void 0===r?void 0:r.call(s,e,t,i))}}function iy(e,t){var i;let n=(null==t?void 0:null===(i=t.gltf)||void 0===i?void 0:i.excludeExtensions)||{},r=e in n&&!n[e];return!r}let ib="KHR_binary_glTF",iE={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},iS={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class iM{constructor(){(0,O.Z)(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),(0,O.Z)(this,"json",void 0)}normalize(e,t){this.json=e.json;let i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(i.asset.version));return}if(!t.normalize)throw Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),function(e){let t=new e4(e),{json:i}=t;for(let e of i.images||[]){let i=t.getObjectExtension(e,ib);i&&Object.assign(e,i),t.removeObjectExtension(e,ib)}i.buffers&&i.buffers[0]&&delete i.buffers[0].uri,t.removeExtension(ib)}(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(let t in iE)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){let i=e[t];if(!(!i||Array.isArray(i)))for(let n in e[t]=[],i){let r=i[n];r.id=r.id||n;let s=e[t].length;e[t].push(r),this.idToIndexMap[t][n]=s}}_convertObjectIdsToArrayIndices(e){for(let t in iE)this._convertIdsToIndices(e,t);for(let t of("scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene")),e.textures))this._convertTextureIds(t);for(let t of e.meshes)this._convertMeshIds(t);for(let t of e.nodes)this._convertNodeIds(t);for(let t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(let t of e.primitives){let{attributes:e,indices:i,material:n}=t;for(let t in e)e[t]=this._convertIdToIndex(e[t],"accessor");i&&(t.indices=this._convertIdToIndex(i,"accessor")),n&&(t.material=this._convertIdToIndex(n,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(e=>this._convertIdToIndex(e,"node"))),e.meshes&&(e.meshes=e.meshes.map(e=>this._convertIdToIndex(e,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(e=>this._convertIdToIndex(e,"node")))}_convertIdsToIndices(e,t){for(let i of(e[t]||(console.warn("gltf v1: json doesn't contain attribute ".concat(t)),e[t]=[]),e[t]))for(let e in i){let t=i[e],n=this._convertIdToIndex(t,e);i[e]=n}}_convertIdToIndex(e,t){let i=iS[t];if(i in this.idToIndexMap){let n=this.idToIndexMap[i][e];if(!Number.isFinite(n))throw Error("gltf v1: failed to resolve ".concat(t," with id ").concat(e));return n}return e}_updateObjects(e){for(let e of this.json.buffers)delete e.type}_updateMaterial(e){for(let r of e.materials){var t,i,n;r.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};let s=(null===(t=r.values)||void 0===t?void 0:t.tex)||(null===(i=r.values)||void 0===i?void 0:i.texture2d_0)||(null===(n=r.values)||void 0===n?void 0:n.diffuseTex),o=e.textures.findIndex(e=>e.id===s);-1!==o&&(r.pbrMetallicRoughness.baseColorTexture={index:o})}}}let iI={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ix={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},iP={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},iR={magFilter:iP.TEXTURE_MAG_FILTER,minFilter:iP.TEXTURE_MIN_FILTER,wrapS:iP.TEXTURE_WRAP_S,wrapT:iP.TEXTURE_WRAP_T},iL={[iP.TEXTURE_MAG_FILTER]:iP.LINEAR,[iP.TEXTURE_MIN_FILTER]:iP.NEAREST_MIPMAP_LINEAR,[iP.TEXTURE_WRAP_S]:iP.REPEAT,[iP.TEXTURE_WRAP_T]:iP.REPEAT};class iT{constructor(){(0,O.Z)(this,"baseUri",""),(0,O.Z)(this,"json",{}),(0,O.Z)(this,"buffers",[]),(0,O.Z)(this,"images",[])}postProcess(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{json:i,buffers:n=[],images:r=[],baseUri:s=""}=e;return ek(i),this.baseUri=s,this.json=i,this.buffers=n,this.images=r,this._resolveTree(this.json,t),this.json}_resolveTree(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],e.bufferViews&&(e.bufferViews=e.bufferViews.map((e,t)=>this._resolveBufferView(e,t))),e.images&&(e.images=e.images.map((e,t)=>this._resolveImage(e,t))),e.samplers&&(e.samplers=e.samplers.map((e,t)=>this._resolveSampler(e,t))),e.textures&&(e.textures=e.textures.map((e,t)=>this._resolveTexture(e,t))),e.accessors&&(e.accessors=e.accessors.map((e,t)=>this._resolveAccessor(e,t))),e.materials&&(e.materials=e.materials.map((e,t)=>this._resolveMaterial(e,t))),e.meshes&&(e.meshes=e.meshes.map((e,t)=>this._resolveMesh(e,t))),e.nodes&&(e.nodes=e.nodes.map((e,t)=>this._resolveNode(e,t))),e.skins&&(e.skins=e.skins.map((e,t)=>this._resolveSkin(e,t))),e.scenes&&(e.scenes=e.scenes.map((e,t)=>this._resolveScene(e,t))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"==typeof t)return t;let i=this.json[e]&&this.json[e][t];return i||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),i}_resolveScene(e,t){return e.id=e.id||"scene-".concat(t),e.nodes=(e.nodes||[]).map(e=>this.getNode(e)),e}_resolveNode(e,t){return e.id=e.id||"node-".concat(t),e.children&&(e.children=e.children.map(e=>this.getNode(e))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((e,t)=>{let i=this.getMesh(t);return e.id=i.id,e.primitives=e.primitives.concat(i.primitives),e},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||"skin-".concat(t),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||"mesh-".concat(t),e.primitives&&(e.primitives=e.primitives.map(e=>{e={...e};let t=e.attributes;for(let i in e.attributes={},t)e.attributes[i]=this.getAccessor(t[i]);return void 0!==e.indices&&(e.indices=this.getAccessor(e.indices)),void 0!==e.material&&(e.material=this.getMaterial(e.material)),e})),e}_resolveMaterial(e,t){if(e.id=e.id||"material-".concat(t),e.normalTexture&&(e.normalTexture={...e.normalTexture},e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture={...e.occlustionTexture},e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture={...e.emmisiveTexture},e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness={...e.pbrMetallicRoughness};let t=e.pbrMetallicRoughness;t.baseColorTexture&&(t.baseColorTexture={...t.baseColorTexture},t.baseColorTexture.texture=this.getTexture(t.baseColorTexture.index)),t.metallicRoughnessTexture&&(t.metallicRoughnessTexture={...t.metallicRoughnessTexture},t.metallicRoughnessTexture.texture=this.getTexture(t.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||"accessor-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=ix[e.componentType],e.components=iI[e.type],e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){let t=e.bufferView.buffer,{ArrayType:i,byteLength:n}=e3(e,e.bufferView),r=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+t.byteOffset,s=t.arrayBuffer.slice(r,r+n);e.bufferView.byteStride&&(s=this._getValueFromInterleavedBuffer(t,r,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new i(s)}return e}_getValueFromInterleavedBuffer(e,t,i,n,r){let s=new Uint8Array(r*n);for(let o=0;o<r;o++){let r=t+o*i;s.set(new Uint8Array(e.arrayBuffer.slice(r,r+n)),o*n)}return s.buffer}_resolveTexture(e,t){return e.id=e.id||"texture-".concat(t),e.sampler="sampler"in e?this.getSampler(e.sampler):iL,e.source=this.getImage(e.source),e}_resolveSampler(e,t){for(let i in e.id=e.id||"sampler-".concat(t),e.parameters={},e){let t=this._enumSamplerParameter(i);void 0!==t&&(e.parameters[t]=e[i])}return e}_enumSamplerParameter(e){return iR[e]}_resolveImage(e,t){e.id=e.id||"image-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));let i=this.images[t];return i&&(e.image=i),e}_resolveBufferView(e,t){let i=e.buffer,n={id:"bufferView-".concat(t),...e,buffer:this.buffers[i]},r=this.buffers[i].arrayBuffer,s=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(s+=e.byteOffset),n.data=new Uint8Array(r,s,e.byteLength),n}_resolveCamera(e,t){return e.id=e.id||"camera-".concat(t),e.perspective,e.orthographic,e}}function iF(e,t,i,n){let r=new Uint8Array(t.buffer,i,n),s=new TextDecoder("utf8"),o=s.decode(r);return e.json=JSON.parse(o),eW(n,4)}function iG(e,t,i,n){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:i,byteLength:n,arrayBuffer:t.buffer}),eW(n,4)}async function iD(e,t){var i,n,r,s;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;(function(e,t,i,n){if(n.uri&&(e.baseUri=n.uri),t instanceof ArrayBuffer&&!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=new DataView(e),{magic:r=1735152710}=i,s=n.getUint32(t,!1);return s===r||1735152710===s}(t,i,n)){let e=new TextDecoder;t=e.decode(t)}if("string"==typeof t)e.json=function(e){try{return JSON.parse(e)}catch(t){throw Error('Failed to parse JSON from data starting with "'.concat(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return"string"==typeof e?e.slice(0,t):ArrayBuffer.isView(e)?ez(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?ez(e,0,t):""}(e),'"'))}}(t);else if(t instanceof ArrayBuffer){let r={};i=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;arguments.length>3&&void 0!==arguments[3]&&arguments[3];let n=new DataView(t),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(String.fromCharCode(e.getUint8(t+0))).concat(String.fromCharCode(e.getUint8(t+1))).concat(String.fromCharCode(e.getUint8(t+2))).concat(String.fromCharCode(e.getUint8(t+3)))}(n,i+0),s=n.getUint32(i+4,!0),o=n.getUint32(i+8,!0);switch(Object.assign(e,{header:{byteOffset:i,byteLength:o,hasBinChunk:!1},type:r,version:s,json:{},binChunks:[]}),i+=12,e.version){case 1:return function(e,t,i){(0,eX.h)(e.header.byteLength>20);let n=t.getUint32(i+0,!0),r=t.getUint32(i+4,!0);return i+=8,(0,eX.h)(0===r),iF(e,t,i,n),i+=n,i+=iG(e,t,i,e.header.byteLength)}(e,n,i);case 2:var a;return a=i,(0,eX.h)(e.header.byteLength>20),function(e,t,i,n){for(;i+8<=e.header.byteLength;){let r=t.getUint32(i+0,!0),s=t.getUint32(i+4,!0);switch(i+=8,s){case 1313821514:iF(e,t,i,r);break;case 5130562:iG(e,t,i,r);break;case 0:n.strict||iF(e,t,i,r);break;case 1:n.strict||iG(e,t,i,r)}i+=eW(r,4)}}(e,n,a,{}),a+e.header.byteLength;default:throw Error("Invalid GLB version ".concat(e.version,". Only supports v1 and v2."))}}(r,t,i,n.glb),ek("glTF"===r.type,"Invalid GLB magic string ".concat(r.type)),e._glb=r,e.json=r.json}else ek(!1,"GLTF: must be ArrayBuffer or string");let r=e.json.buffers||[];if(e.buffers=Array(r.length).fill(null),e._glb&&e._glb.header.hasBinChunk){let{binChunks:t}=e._glb;e.buffers[0]={arrayBuffer:t[0].arrayBuffer,byteOffset:t[0].byteOffset,byteLength:t[0].byteLength}}let s=e.json.images||[];e.images=Array(s.length).fill({})})(e,t,o,a),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};new iM().normalize(e,t)}(e,{normalize:null==a?void 0:null===(i=a.gltf)||void 0===i?void 0:i.normalize}),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,n=i_.filter(e=>iy(e.name,t));for(let s of n){var r;null===(r=s.preprocess)||void 0===r||r.call(s,e,t,i)}}(e,a,l);let c=[];if(null!=a&&null!==(n=a.gltf)&&void 0!==n&&n.loadBuffers&&e.json.buffers&&await iO(e,a,l),null!=a&&null!==(r=a.gltf)&&void 0!==r&&r.loadImages){let t=iw(e,a,l);c.push(t)}let u=iv(e,a,l);return c.push(u),await Promise.all(c),null!=a&&null!==(s=a.gltf)&&void 0!==s&&s.postProcess?new iT().postProcess(e,a):e}async function iO(e,t,i){let n=e.json.buffers||[];for(let o=0;o<n.length;++o){let a=n[o];if(a.uri){var r,s;let{fetch:n}=i;ek(n);let l=eK(a.uri,t),c=await (null==i?void 0:null===(r=i.fetch)||void 0===r?void 0:r.call(i,l)),u=await (null==c?void 0:null===(s=c.arrayBuffer)||void 0===s?void 0:s.call(c));e.buffers[o]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete a.uri}else null===e.buffers[o]&&(e.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}async function iw(e,t,i){let n=function(e){let t=new Set,i=e.json.textures||[];for(let e of i)void 0!==e.source&&t.add(e.source);return Array.from(t).sort()}(e),r=e.json.images||[],s=[];for(let o of n)s.push(iH(e,r[o],o,t,i));return await Promise.all(s)}async function iH(e,t,i,n,r){let s;let{fetch:o,parse:a}=r;if(t.uri&&!t.hasOwnProperty("bufferView")){let e=eK(t.uri,n),i=await o(e);s=await i.arrayBuffer(),t.bufferView={data:s}}if(Number.isFinite(t.bufferView)){let i=function(e,t,i){let n=e.bufferViews[i];ek(n);let r=n.buffer,s=t[r];ek(s);let o=(n.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,o,n.byteLength)}(e.json,e.buffers,t.bufferView);s=(0,ej.qv)(i.buffer,i.byteOffset,i.byteLength)}ek(s,"glTF image has no data");let l=await a(s,[eZ.S,eJ],{mimeType:t.mimeType,basis:n.basis||{format:eU()}},r);l&&l[0]&&(l={compressed:!0,mipmaps:!1,width:l[0].width,height:l[0].height,data:l[0]}),e.images=e.images||[],e.images[i]=l}let iU={name:"glTF",id:"gltf",module:"gltf",version:"3.4.4",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:iN,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};async function iN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;(t={...iU.options,...t}).gltf={...iU.options.gltf,...t.gltf};let{byteOffset:n=0}=t;return await iD({},e,n,t,i)}async function iJ(e){let t=[];return e.scenes.forEach(e=>{e.traverse(e=>{Object.values(e.model.getUniforms()).forEach(e=>{!1===e.loaded&&t.push(e)})})}),await iZ(()=>t.some(e=>!e.loaded))}async function iZ(e){for(;e();)await new Promise(e=>requestAnimationFrame(e))}var iz=i(7805);let ij=[255,255,255,255],ik={scenegraph:{type:"object",value:null,async:!0},getScene:e=>e&&e.scenes?"object"==typeof e.scene?e.scene:e.scenes[e.scene||0]:e,getAnimator:e=>e&&e.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:ij},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[iU]};class iK extends w.Z{constructor(...e){super(...e),(0,O.Z)(this,"state",void 0)}getShaders(){let e=[H.Z,U.Z];return"pbr"===this.props._lighting&&e.push(z),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  vec3 normal = vec3(0.0, 0.0, 1.0);\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;\n    #endif\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    geometry.normal = project_normal(normal);\n    geometry.worldPosition += pos;\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n    geometry.normal = project_normal(normal);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n    #ifdef HAS_NORMALS\n      pbr_vNormal = geometry.normal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:e}}initializeState(){let e=this.getAttributeManager();e.addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:ij,transition:!0},instanceModelMatrix:iz.P})}updateState(e){super.updateState(e);let{props:t,oldProps:i}=e;t.scenegraph!==i.scenegraph?this._updateScenegraph():t._animations!==i._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,t._animations)}finalizeState(e){super.finalizeState(e),this._deleteScenegraph()}_updateScenegraph(){let e=this.props,{gl:t}=this.context,i=null;if(e.scenegraph instanceof X)i={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){let n=e.scenegraph,r=function(e,t,i){let n=new ep(e,i),r=n.instantiate(t),s=n.createAnimator();return{scenes:r,animator:s}}(t,n,this._getModelOptions());i={gltf:n,...r},iJ(r).then(()=>this.setNeedsRedraw())}else e.scenegraph&&(N.Z.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),i=e.scenegraph);let n={layer:this,gl:t},r=e.getScene(i,n),s=e.getAnimator(i,n);r instanceof X?(this._deleteScenegraph(),this._applyAllAttributes(r),this._applyAnimationsProp(r,s,e._animations),this.setState({scenegraph:r,animator:s})):null!==r&&N.Z.warn("invalid scenegraph:",r)()}_applyAllAttributes(e){if(this.state.attributesAvailable){let t=this.getAttributeManager().getAttributes();e.traverse(e=>{this._setModelAttributes(e.model,t)})}}_applyAnimationsProp(e,t,i){if(!e||!t||!i)return;let n=t.getAnimations();Object.keys(i).sort().forEach(e=>{let t=i[e];if("*"===e)n.forEach(e=>{Object.assign(e,t)});else if(Number.isFinite(Number(e))){let i=Number(e);i>=0&&i<n.length?Object.assign(n[i],t):N.Z.warn("animation ".concat(e," not found"))()}else{let i=n.find(({name:t})=>t===e);i?Object.assign(i,t):N.Z.warn("animation ".concat(e," not found"))()}})}_deleteScenegraph(){let{scenegraph:e}=this.state;e instanceof X&&e.delete()}_getModelOptions(){let{_imageBasedLightingEnvironment:e}=this.props,t=null;return e&&(t="function"==typeof e?e({gl:this.context.gl,layer:this}):e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:t,modelOptions:{isInstanced:!0,transpileToGLSL100:!(0,J.D0)(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(e){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(t=>{this._setModelAttributes(t.model,e)})}draw({moduleParameters:e=null,parameters:t={},context:i}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(i.timeline.getTime()),this.setNeedsRedraw());let{viewport:n}=this.context,{sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o,opacity:a,coordinateSystem:l}=this.props,c=this.getNumInstances();this.state.scenegraph.traverse((i,{worldMatrix:u})=>{i.model.setInstanceCount(c),i.updateModuleSettings(e),i.draw({parameters:t,uniforms:{sizeScale:r,opacity:a,sizeMinPixels:s,sizeMaxPixels:o,composeModelMatrix:(0,iz.X)(n,l),sceneModelMatrix:u,u_Camera:i.model.getUniforms().project_uCameraPosition}})})}}(0,O.Z)(iK,"defaultProps",ik),(0,O.Z)(iK,"layerName","ScenegraphLayer")},7805:function(e,t,i){i.d(t,{P:function(){return u},X:function(){return h}});var n=i(8550),r=i(4088);let s=Math.PI/180,o=new Float32Array(16),a=new Float32Array(12);function l(e,t,i){let n=t[0]*s,r=t[1]*s,o=t[2]*s,a=Math.sin(o),l=Math.sin(n),c=Math.sin(r),u=Math.cos(o),h=Math.cos(n),d=Math.cos(r),f=i[0],g=i[1],p=i[2];e[0]=f*d*h,e[1]=f*c*h,e[2]=-(f*l),e[3]=g*(-c*u+d*l*a),e[4]=g*(d*u+c*l*a),e[5]=g*h*a,e[6]=p*(c*a+d*l*u),e[7]=p*(-d*a+c*l*u),e[8]=p*h*u}function c(e){return e[0]=e[0],e[1]=e[1],e[2]=e[2],e[3]=e[4],e[4]=e[5],e[5]=e[6],e[6]=e[8],e[7]=e[9],e[8]=e[10],e[9]=e[12],e[10]=e[13],e[11]=e[14],e.subarray(0,12)}let u={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(e,{startRow:t,endRow:i}){let{data:r,getOrientation:s,getScale:u,getTranslation:h,getTransformMatrix:d}=this.props,f=Array.isArray(d),g=f&&16===d.length,p=Array.isArray(u),A=Array.isArray(s),m=Array.isArray(h),C=g||!f&&!!d(r[0]);C?e.constant=g:e.constant=A&&p&&m;let B=e.value;if(e.constant){let t;C?(o.set(d),t=c(o)):(l(t=a,s,u),t.set(h,9)),e.value=new Float32Array(t)}else{let f=t*e.size,{iterable:_,objectInfo:v}=(0,n.jB)(r,t,i);for(let e of _){let t;if(v.index++,C)o.set(g?d:d(e,v)),t=c(o);else{t=a;let i=A?s:s(e,v),n=p?u:u(e,v);l(t,i,n),t.set(m?h:h(e,v),9)}B[f++]=t[0],B[f++]=t[1],B[f++]=t[2],B[f++]=t[3],B[f++]=t[4],B[f++]=t[5],B[f++]=t[6],B[f++]=t[7],B[f++]=t[8],B[f++]=t[9],B[f++]=t[10],B[f++]=t[11]}}}};function h(e,t){return t===r.Df.CARTESIAN||t===r.Df.METER_OFFSETS||t===r.Df.DEFAULT&&!e.isGeospatial}},435:function(e,t,i){i.d(t,{v:function(){return n}});function n(e){let t=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0,a=e.POSITION?e.POSITION.value:[],l=a&&a.length;for(let e=0;e<l;e+=3){let l=a[e],c=a[e+1],u=a[e+2];t=l<t?l:t,i=c<i?c:i,n=u<n?u:n,r=l>r?l:r,s=c>s?c:s,o=u>o?u:o}return[[t,i,n],[r,s,o]]}},3982:function(e,t,i){i.d(t,{Z:function(){return o}});var n=i(4538),r=i(2525);let s={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class o{static get DRAW_MODE(){return s}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{id:t=(0,n.hQ)("geometry"),drawMode:i=s.TRIANGLES,attributes:r={},indices:o=null,vertexCount:a=null}=e;this.id=t,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,o),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,t){for(let i in t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t),e){let t=e[i];t=ArrayBuffer.isView(t)?{value:t}:t,(0,r.h)(ArrayBuffer.isView(t.value),"".concat(this._print(i),": must be typed array or object with value as typed array")),"POSITION"!==i&&"positions"!==i||t.size||(t.size=3),"indices"===i?((0,r.h)(!this.indices),this.indices=t):this.attributes[i]=t}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(let t in e){let n=e[t],{value:r,size:s,constant:o}=n;!o&&r&&s>=1&&(i=Math.min(i,r.length/s))}return(0,r.h)(Number.isFinite(i)),i}}},6931:function(e,t,i){i.d(t,{H:function(){return o}});var n="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n";let r={lightSources:{}};function s(){let{color:e=[0,0,0],intensity:t=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.map(e=>e*t/255)}let o={name:"lights",vs:n,fs:n,getUniforms:function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;if("lightSources"in t){let{ambientLight:e,pointLights:i,directionalLights:n}=t.lightSources||{},r=e||i&&i.length>0||n&&n.length>0;return r?Object.assign({},function(e){let{ambientLight:t,pointLights:i=[],directionalLights:n=[]}=e,r={};return t?r["lighting_uAmbientLight.color"]=s(t):r["lighting_uAmbientLight.color"]=[0,0,0],i.forEach((e,t)=>{r["lighting_uPointLight[".concat(t,"].color")]=s(e),r["lighting_uPointLight[".concat(t,"].position")]=e.position,r["lighting_uPointLight[".concat(t,"].attenuation")]=e.attenuation||[1,0,0]}),r.lighting_uPointLightCount=i.length,n.forEach((e,t)=>{r["lighting_uDirectionalLight[".concat(t,"].color")]=s(e),r["lighting_uDirectionalLight[".concat(t,"].direction")]=e.direction}),r.lighting_uDirectionalLightCount=n.length,r}({ambientLight:e,pointLights:i,directionalLights:n}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){let i={pointLights:[],directionalLights:[]};for(let e of t.lights||[])switch(e.type){case"ambient":i.ambientLight=e;break;case"directional":i.directionalLights.push(e);break;case"point":i.pointLights.push(e)}return e({lightSources:i})}return{}},defines:{MAX_LIGHTS:3}}},8674:function(e,t,i){i.d(t,{N:function(){return a},s:function(){return l}});var n=i(6931),r="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n";let s={};function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;if(!("material"in e))return{};let{material:t}=e;return t?function(e){let{ambient:t=.35,diffuse:i=.6,shininess:n=32,specularColor:r=[30,30,30]}=e;return{lighting_uAmbient:t,lighting_uDiffuse:i,lighting_uShininess:n,lighting_uSpecularColor:r.map(e=>e/255)}}(t):{lighting_uEnabled:!1}}let a={name:"gouraud-lighting",dependencies:[n.H],vs:r,defines:{LIGHTING_VERTEX:1},getUniforms:o},l={name:"phong-lighting",dependencies:[n.H],fs:r,defines:{LIGHTING_FRAGMENT:1},getUniforms:o}},540:function(e,t,i){let n,r;i.d(t,{Z:function(){return g}});var s,o,a=i(1e3),l=i(6281),c=i(1031),u=i(5600),h=i(1437),d=i(7160);(s=o||(o={}))[s.COL0ROW0=0]="COL0ROW0",s[s.COL0ROW1=1]="COL0ROW1",s[s.COL0ROW2=2]="COL0ROW2",s[s.COL1ROW0=3]="COL1ROW0",s[s.COL1ROW1=4]="COL1ROW1",s[s.COL1ROW2=5]="COL1ROW2",s[s.COL2ROW0=6]="COL2ROW0",s[s.COL2ROW1=7]="COL2ROW1",s[s.COL2ROW2=8]="COL2ROW2";let f=Object.freeze([1,0,0,0,1,0,0,0,1]);class g extends a.Z{static get IDENTITY(){return r||Object.freeze(r=new g),r}static get ZERO(){return n||Object.freeze(n=new g([0,0,0,0,0,0,0,0,0])),n}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return o}constructor(e,...t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1==arguments.length&&Array.isArray(e)?this.copy(e):t.length>0?this.copy([e,...t]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(f)}fromObject(e){return this.check()}fromQuaternion(e){return u.en(this,e),this.check()}set(e,t,i,n,r,s,o,a,l){return this[0]=e,this[1]=t,this[2]=i,this[3]=n,this[4]=r,this[5]=s,this[6]=o,this[7]=a,this[8]=l,this.check()}setRowMajor(e,t,i,n,r,s,o,a,l){return this[0]=e,this[1]=n,this[2]=o,this[3]=t,this[4]=r,this[5]=a,this[6]=i,this[7]=s,this[8]=l,this.check()}determinant(){return u.GH(this)}transpose(){return u.p4(this,this),this.check()}invert(){return u.U_(this,this),this.check()}multiplyLeft(e){return u.Jp(this,e,this),this.check()}multiplyRight(e){return u.Jp(this,this,e),this.check()}rotate(e){return u.U1(this,this,e),this.check()}scale(e){return Array.isArray(e)?u.bA(this,this,e):u.bA(this,this,[e,e]),this.check()}translate(e){return u.Iu(this,this,e),this.check()}transform(e,t){let i;switch(e.length){case 2:i=h.kK(t||[-0,-0],e,this);break;case 3:i=d.kK(t||[-0,-0,-0],e,this);break;case 4:i=(0,c._x)(t||[-0,-0,-0,-0],e,this);break;default:throw Error("Illegal vector")}return(0,l.IL)(i,e.length),i}transformVector(e,t){return this.transform(e,t)}transformVector2(e,t){return this.transform(e,t)}transformVector3(e,t){return this.transform(e,t)}}},9108:function(e,t,i){let n;i.d(t,{Z:function(){return P}});var r,s,o,a=i(6357),l=i(6281),c=i(9521),u=i(4034),h=i(7160),d=i(1031);class f extends c.Z{static get ZERO(){return n||Object.freeze(n=new f(0,0,0,0)),n}constructor(e=0,t=0,i=0,n=0){super(-0,-0,-0,-0),(0,u.kJ)(e)&&1==arguments.length?this.copy(e):(u.vc.debug&&((0,l.u5)(e),(0,l.u5)(t),(0,l.u5)(i),(0,l.u5)(n)),this[0]=e,this[1]=t,this[2]=i,this[3]=n)}set(e,t,i,n){return this[0]=e,this[1]=t,this[2]=i,this[3]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return u.vc.debug&&((0,l.u5)(e.x),(0,l.u5)(e.y),(0,l.u5)(e.z),(0,l.u5)(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=(0,l.u5)(e)}get w(){return this[3]}set w(e){this[3]=(0,l.u5)(e)}transform(e){return h.fF(this,this,e),this.check()}transformByMatrix3(e){return(0,d._x)(this,this,e),this.check()}transformByMatrix2(e){return(0,d.G7)(this,this,e),this.check()}transformByQuaternion(e){return h.VC(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}var g=i(9685),p=i(5600),A=i(8333);function m(){var e=new g.WT(4);return g.WT!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function C(e,t,i){var n=Math.sin(i*=.5);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(i),e}function B(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3],a=i[0],l=i[1],c=i[2],u=i[3];return e[0]=n*u+o*a+r*c-s*l,e[1]=r*u+o*l+s*a-n*c,e[2]=s*u+o*c+n*l-r*a,e[3]=o*u-n*a-r*l-s*c,e}A.d9,A.al,A.JG,A.t8;var _=A.IH,v=A.bA,y=A.AK,b=A.t7,E=A.kE,S=A.we,M=A.Fv;A.I6,A.fS;var I=(r=h.Ue(),s=h.al(1,0,0),o=h.al(0,1,0),function(e,t,i){var n=h.AK(t,i);return n<-.999999?(h.kC(r,s,t),1e-6>h.Zh(r)&&h.kC(r,o,t),h.Fv(r,r),C(e,r,Math.PI),e):n>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(h.kC(r,t,i),e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=1+n,M(e,e))});m(),m(),p.Ue();let x=[0,0,0,1];class P extends a.Z{constructor(e=0,t=0,i=0,n=1){super(-0,-0,-0,-0),Array.isArray(e)&&1==arguments.length?this.copy(e):this.set(e,t,i,n)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,n){return this[0]=e,this[1]=t,this[2]=i,this[3]=n,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return!function(e,t){var i,n=t[0]+t[4]+t[8];if(n>0)i=Math.sqrt(n+1),e[3]=.5*i,i=.5/i,e[0]=(t[5]-t[7])*i,e[1]=(t[6]-t[2])*i,e[2]=(t[1]-t[3])*i;else{var r=0;t[4]>t[0]&&(r=1),t[8]>t[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(t[3*r+r]-t[3*s+s]-t[3*o+o]+1),e[r]=.5*i,i=.5/i,e[3]=(t[3*s+o]-t[3*o+s])*i,e[s]=(t[3*s+r]+t[3*r+s])*i,e[o]=(t[3*o+r]+t[3*r+o])*i}}(this,e),this.check()}fromAxisRotation(e,t){return C(this,e,t),this.check()}identity(){return this[0]=0,this[1]=0,this[2]=0,this[3]=1,this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=(0,l.u5)(e)}get y(){return this[1]}set y(e){this[1]=(0,l.u5)(e)}get z(){return this[2]}set z(e){this[2]=(0,l.u5)(e)}get w(){return this[3]}set w(e){this[3]=(0,l.u5)(e)}len(){return E(this)}lengthSquared(){return S(this)}dot(e){return y(this,e)}rotationTo(e,t){return I(this,e,t),this.check()}add(e){return _(this,this,e),this.check()}calculateW(){var e,t,i;return e=this[0],t=this[1],i=this[2],this[0]=e,this[1]=t,this[2]=i,this[3]=Math.sqrt(Math.abs(1-e*e-t*t-i*i)),this.check()}conjugate(){return this[0]=-this[0],this[1]=-this[1],this[2]=-this[2],this[3]=this[3],this.check()}invert(){var e,t,i,n,r,s;return e=this[0],t=this[1],s=(r=e*e+t*t+(i=this[2])*i+(n=this[3])*n)?1/r:0,this[0]=-e*s,this[1]=-t*s,this[2]=-i*s,this[3]=n*s,this.check()}lerp(e,t,i){return void 0===i?this.lerp(this,e,t):(b(this,e,t,i),this.check())}multiplyRight(e){return B(this,this,e),this.check()}multiplyLeft(e){return B(this,e,this),this.check()}normalize(){let e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){var t,i,n,r,s,o,a;return t=.5*e,i=this[0],n=this[1],r=this[2],s=this[3],o=Math.sin(t),a=Math.cos(t),this[0]=i*a+s*o,this[1]=n*a+r*o,this[2]=r*a-n*o,this[3]=s*a-i*o,this.check()}rotateY(e){var t,i,n,r,s,o,a;return t=.5*e,i=this[0],n=this[1],r=this[2],s=this[3],o=Math.sin(t),a=Math.cos(t),this[0]=i*a-r*o,this[1]=n*a+s*o,this[2]=r*a+i*o,this[3]=s*a-n*o,this.check()}rotateZ(e){var t,i,n,r,s,o,a;return t=.5*e,i=this[0],n=this[1],r=this[2],s=this[3],o=Math.sin(t),a=Math.cos(t),this[0]=i*a+n*o,this[1]=n*a-i*o,this[2]=r*a+s*o,this[3]=s*a-r*o,this.check()}scale(e){return v(this,this,e),this.check()}slerp(e,t,i){var n,r,s,o,a,l,c,u,h,d,f,p,A,m,C,B;let _,v,y;switch(arguments.length){case 1:({start:_=x,target:v,ratio:y}=e);break;case 2:_=this,v=e,y=t;break;default:_=e,v=t,y=i}return n=_,r=v,s=y,h=n[0],d=n[1],f=n[2],p=n[3],A=r[0],m=r[1],(a=h*A+d*m+f*(C=r[2])+p*(B=r[3]))<0&&(a=-a,A=-A,m=-m,C=-C,B=-B),1-a>g.Ib?(l=Math.sin(o=Math.acos(a)),c=Math.sin((1-s)*o)/l,u=Math.sin(s*o)/l):(c=1-s,u=s),this[0]=c*h+u*A,this[1]=c*d+u*m,this[2]=c*f+u*C,this[3]=c*p+u*B,this.check()}transformVector4(e,t=new f){return A.VC(t,e,this),(0,l.IL)(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}},9513:function(e,t,i){i.d(t,{wG:function(){return n},WZ:function(){return d},GU:function(){return A},dj:function(){return u},ct:function(){return p},Ny:function(){return r}});let n={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function r(e,t,i={}){let n=function(e,t={}){return Math.sign(function(e,t={}){let{start:i=0,end:n=e.length}=t,r=t.size||2,s=0;for(let t=i,o=n-r;t<n;t+=r)s+=(e[t]-e[o])*(e[t+1]+e[o+1]),o=t;return s/2}(e,t))}(e,i);return n!==t&&(function(e,t){let{start:i=0,end:n=e.length,size:r=2}=t,s=(n-i)/r,o=Math.floor(s/2);for(let t=0;t<o;++t){let n=i+t*r,o=i+(s-1-t)*r;for(let t=0;t<r;++t){let i=e[n+t];e[n+t]=e[o+t],e[o+t]=i}}}(e,i),!0)}function s(e,t,i,n,r=[]){let s,o;if(8&i)s=(n[3]-e[1])/(t[1]-e[1]),o=3;else if(4&i)s=(n[1]-e[1])/(t[1]-e[1]),o=1;else if(2&i)s=(n[2]-e[0])/(t[0]-e[0]),o=2;else{if(!(1&i))return null;s=(n[0]-e[0])/(t[0]-e[0]),o=0}for(let i=0;i<e.length;i++)r[i]=(1&o)===i?n[o]:s*(t[i]-e[i])+e[i];return r}function o(e,t){let i=0;return e[0]<t[0]?i|=1:e[0]>t[2]&&(i|=2),e[1]<t[1]?i|=4:e[1]>t[3]&&(i|=8),i}function a(e,t){let i=t.length,n=e.length;if(n>0){let r=!0;for(let s=0;s<i;s++)if(e[n-i+s]!==t[s]){r=!1;break}if(r)return!1}for(let r=0;r<i;r++)e[n+r]=t[r];return!0}function l(e,t){let i=t.length;for(let n=0;n<i;n++)e[n]=t[n]}function c(e,t,i,n,r=[]){let s=n+t*i;for(let t=0;t<i;t++)r[t]=e[s+t];return r}function u(e,t){let i,n;let{size:r=2,broken:u=!1,gridResolution:h=10,gridOffset:d=[0,0],startIndex:f=0,endIndex:p=e.length}=t||{},A=(p-f)/r,m=[],C=[m],B=c(e,0,r,f),_=g(B,h,d,[]),v=[];a(m,B);for(let t=1;t<A;t++){for(n=o(i=c(e,t,r,f,i),_);n;){var y;s(B,i,n,_,v);let e=o(v,_);e&&(s(B,v,e,_,v),n=e),a(m,v),l(B,v),8&(y=n)?(_[1]+=h,_[3]+=h):4&y?(_[1]-=h,_[3]-=h):2&y?(_[0]+=h,_[2]+=h):1&y&&(_[0]-=h,_[2]-=h),u&&m.length>r&&(m=[],C.push(m),a(m,B)),n=o(i,_)}a(m,i),l(B,i)}return u?C:C[0]}function h(e,t){for(let i=0;i<t.length;i++)e.push(t[i]);return e}function d(e,t=null,i){if(!e.length)return[];let{size:n=2,gridResolution:r=10,gridOffset:s=[0,0],edgeTypes:a=!1}=i||{},l=[],c=[{pos:e,types:a?Array(e.length/n).fill(1):null,holes:t||[]}],u=[[],[]],d=[];for(;c.length;){let{pos:e,types:t,holes:i}=c.shift();(function(e,t,i,n){let r=1/0,s=-1/0,o=1/0,a=-1/0;for(let n=0;n<i;n+=t){let t=e[n],i=e[n+1];r=t<r?t:r,s=t>s?t:s,o=i<o?i:o,a=i>a?i:a}n[0][0]=r,n[0][1]=o,n[1][0]=s,n[1][1]=a})(e,n,i[0]||e.length,u),d=g(u[0],r,s,d);let p=o(u[1],d);if(p){let r=f(e,t,n,0,i[0]||e.length,d,p),s={pos:r[0].pos,types:r[0].types,holes:[]},o={pos:r[1].pos,types:r[1].types,holes:[]};c.push(s,o);for(let l=0;l<i.length;l++)(r=f(e,t,n,i[l],i[l+1]||e.length,d,p))[0]&&(s.holes.push(s.pos.length),s.pos=h(s.pos,r[0].pos),a&&(s.types=h(s.types,r[0].types))),r[1]&&(o.holes.push(o.pos.length),o.pos=h(o.pos,r[1].pos),a&&(o.types=h(o.types,r[1].types)))}else{let n={positions:e};a&&(n.edgeTypes=t),i.length&&(n.holeIndices=i),l.push(n)}}return l}function f(e,t,i,n,r,o,u){let h,d,f;let g=(r-n)/i,p=[],A=[],m=[],C=[],B=[],_=c(e,g-1,i,n),v=Math.sign(8&u?_[1]-o[3]:_[0]-o[2]),y=t&&t[g-1],b=0,E=0;for(let r=0;r<g;r++)h=c(e,r,i,n,h),d=Math.sign(8&u?h[1]-o[3]:h[0]-o[2]),f=t&&t[n/i+r],d&&v&&v!==d&&(s(_,h,u,o,B),a(p,B)&&m.push(y),a(A,B)&&C.push(y)),d<=0?(a(p,h)&&m.push(f),b-=d):m.length&&(m[m.length-1]=0),d>=0?(a(A,h)&&C.push(f),E+=d):C.length&&(C[C.length-1]=0),l(_,h),v=d,y=f;return[b?{pos:p,types:t&&m}:null,E?{pos:A,types:t&&C}:null]}function g(e,t,i,n){let r=Math.floor((e[0]-i[0])/t)*t+i[0],s=Math.floor((e[1]-i[1])/t)*t+i[1];return n[0]=r,n[1]=s,n[2]=r+t,n[3]=s+t,n}function p(e,t){let{size:i=2,startIndex:n=0,endIndex:r=e.length,normalize:s=!0}=t||{},o=e.slice(n,r);m(o,i,0,r-n);let a=u(o,{size:i,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(let e of a)C(e,i);return a}function A(e,t=null,i){let{size:n=2,normalize:r=!0,edgeTypes:s=!1}=i||{};t=t||[];let o=[],l=[],u=0,h=0;for(let r=0;r<=t.length;r++){let s=t[r]||e.length,d=h,f=function(e,t,i,n){let r=-1,s=-1;for(let o=i+1;o<n;o+=t){let t=Math.abs(e[o]);t>r&&(r=t,s=o-1)}return s}(e,n,u,s);for(let t=f;t<s;t++)o[h++]=e[t];for(let t=u;t<f;t++)o[h++]=e[t];m(o,n,d,h),function(e,t,i,n,r=85.051129){let s=e[i],o=e[n-t];if(Math.abs(s-o)>180){let n=c(e,0,t,i);n[0]+=360*Math.round((o-s)/360),a(e,n),n[1]=Math.sign(n[1])*r,a(e,n),n[0]=s,a(e,n)}}(o,n,d,h,null==i?void 0:i.maxLatitude),u=s,l[r]=h}l.pop();let f=d(o,l,{size:n,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(r)for(let e of f)C(e.positions,n);return f}function m(e,t,i,n){let r,s=e[0];for(let o=i;o<n;o+=t){r=e[o];let t=r-s;(t>180||t<-180)&&(r-=360*Math.round(t/360)),e[o]=s=r}}function C(e,t){let i;let n=e.length/t;for(let r=0;r<n&&((i=e[r*t])+180)%360==0;r++);let r=-(360*Math.round(i/360));if(0!==r)for(let i=0;i<n;i++)e[i*t]+=r}},6010:function(e,t,i){t.Z=function(){for(var e,t,i=0,n="";i<arguments.length;)(e=arguments[i++])&&(t=function e(t){var i,n,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t){if(Array.isArray(t))for(i=0;i<t.length;i++)t[i]&&(n=e(t[i]))&&(r&&(r+=" "),r+=n);else for(i in t)t[i]&&(r&&(r+=" "),r+=i)}return r}(e))&&(n&&(n+=" "),n+=t);return n}},5600:function(e,t,i){i.d(t,{GH:function(){return a},Iu:function(){return c},Jp:function(){return l},U1:function(){return u},U_:function(){return o},Ue:function(){return r},bA:function(){return h},en:function(){return d},p4:function(){return s}});var n=i(9685);function r(){var e=new n.WT(9);return n.WT!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function s(e,t){if(e===t){var i=t[1],n=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=n,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function o(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=u*o-a*c,d=-u*s+a*l,f=c*s-o*l,g=i*h+n*d+r*f;return g?(g=1/g,e[0]=h*g,e[1]=(-u*n+r*c)*g,e[2]=(a*n-r*o)*g,e[3]=d*g,e[4]=(u*i-r*l)*g,e[5]=(-a*i+r*s)*g,e[6]=f*g,e[7]=(-c*i+n*l)*g,e[8]=(o*i-n*s)*g,e):null}function a(e){var t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*(c*s-o*l)+i*(-c*r+o*a)+n*(l*r-s*a)}function l(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=i[0],f=i[1],g=i[2],p=i[3],A=i[4],m=i[5],C=i[6],B=i[7],_=i[8];return e[0]=d*n+f*o+g*c,e[1]=d*r+f*a+g*u,e[2]=d*s+f*l+g*h,e[3]=p*n+A*o+m*c,e[4]=p*r+A*a+m*u,e[5]=p*s+A*l+m*h,e[6]=C*n+B*o+_*c,e[7]=C*r+B*a+_*u,e[8]=C*s+B*l+_*h,e}function c(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=i[0],f=i[1];return e[0]=n,e[1]=r,e[2]=s,e[3]=o,e[4]=a,e[5]=l,e[6]=d*n+f*o+c,e[7]=d*r+f*a+u,e[8]=d*s+f*l+h,e}function u(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=Math.sin(i),f=Math.cos(i);return e[0]=f*n+d*o,e[1]=f*r+d*a,e[2]=f*s+d*l,e[3]=f*o-d*n,e[4]=f*a-d*r,e[5]=f*l-d*s,e[6]=c,e[7]=u,e[8]=h,e}function h(e,t,i){var n=i[0],r=i[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=r*t[3],e[4]=r*t[4],e[5]=r*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function d(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=i+i,a=n+n,l=r+r,c=i*o,u=n*o,h=n*a,d=r*o,f=r*a,g=r*l,p=s*o,A=s*a,m=s*l;return e[0]=1-h-g,e[3]=u-m,e[6]=d+A,e[1]=u+m,e[4]=1-c-g,e[7]=f-p,e[2]=d-A,e[5]=f+p,e[8]=1-c-h,e}}}]);